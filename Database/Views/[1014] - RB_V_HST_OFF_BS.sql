--------------------------------------------------------
--  DDL for View RB_V_HST_OFF_BS
--------------------------------------------------------

CREATE OR REPLACE NOFORCE VIEW "RB_V_HST_OFF_BS" (
	TGK_TABLE_SEGMENT,
	RB_ROWID,
	MONTH_END_DATE,
	REPORTING_ENTITY,
	INSTRUMENT,
	CALL_CODE,
	CALL_CODE_DESC,
	GL_KEY_CODE,
	GL_KEY_CODE_DESC,
	CONSOL_NODE,
	BUSINESS_UNIT,
	CURRENCY_CODE,
	FOREIGN_AMOUNT,
	CURRENCY_USQ,
	BASE_EQUIVALENT,
	ORIGINATION_DATE,
	MATURITY_DATE,
	REMAINING_MATURITY_DAYS,
	FRONTED_UNFUNDED_PARTICIPANTS,
	CUSTOMER_ID,
	CUSTOMER_NAME,
	"DEPO_NON-DEPO",
	FOREIGN_DOMESTIC,
	CANCELLABLE_Y_N,
	MATURITY_BUCKETS,
	SECURITIZATION_EXPO,
	CREDIT_CONVERSION_FACTOR,
	CREDIT_EQUIVALENT_AMT,
	RISK_COUNTRY,
	RISK_COUNTRY_CODE,
	RISK_WEIGHTED_CATEGORY,
	RISK_WEIGHTED_ALLOCATION,
	UMD_1,
	UMD_2,
	UMD_3,
	SECURED_Y_N,
	GUARANTEED_Y_N,
	GOVT_GUARANTEED_PERCENTAGE ,
	QUALIFIED_CENTRAL_CPT_Y_N,
	ABCP_CONDUITS_AMT,
	SOVERIGN_DEFAULT_Y_N,
	CRC_RATING_OF_OECD_EXPOSURES,
	US_GAAP_RISK_RATING,
	IFRS_RISK_RATING,
	FACILITY_LIMIT_AMOUNT,
	FACILITY_USED_AMOUNT,
	SYNDICATED_RABOSHARE,
	"SYNDICATED_RABOSHARE_%",
	SYNDICATED_PARTICIPANTS,
	"SYNDICATED_PARTICIPANTS_%",
	SOURCE,
	UMD_4,
	UMD_5,
	UMD_6,
	TRADE_ID,
	REPORTABLE_Y_N,
	BU ,
	ACCOUNT,
	PRODUCT,
	OPERATING_UNIT,
	DEPTID,
	CUST_CLASS,
	AFFILIATE,
	CIF_TYPE,
	CUSTOMER_TYPE,
	LOAN_CALL_CODE,
	PRODUCT_GROUP,
	FACILITY_TYPE,
	FACILITY_TYPE_DESC,
	CALL_CODE_CODEBLOCK,
	CCF_CODEBLOCK,
	FILLER_1,
	FILLER_2,
	FILLER_3,
	FILLER_4,
	FILLER_5,
	FILLER_6,
	FILLER_7,
	FILLER_8,
	FILLER_9,
	FILLER_10,
	FILLER_11,
	FILLER_12,
	FILLER_13,
	FILLER_14,
	FILLER_15,
	FILLER_16,
	FILLER_17,
	FILLER_18,
	FILLER_19,
	FILLER_20,
	FILLER_21,
	FILLER_22,
	FILLER_23,
	FILLER_24,
	FILLER_25,
	PROVENIENZA,
	USERUPD,
	DATEUPD
) AS 
SELECT
	CAST(DATA.TGK_TABLE_SEGMENT AS VARCHAR(2)) AS TGK_TABLE_SEGMENT,
	CAST(KEYS.RB_ROWID AS NUMBER(38,0)) AS RB_ROWID,
	TO_DATE(KEYS.MONTH_END_DATE, 'MM/DD/YYYY') AS MONTH_END_DATE,
	CAST(KEYS.REPORTING_ENTITY AS VARCHAR2(6)) AS REPORTING_ENTITY,
	CAST(DATA.INSTRUMENT AS VARCHAR2(27)) AS INSTRUMENT,
	CAST(DATA.CALL_CODE AS VARCHAR2(15)) AS CALL_CODE,
	CAST(DATA.CALL_CODE_DESC AS VARCHAR2(150)) AS CALL_CODE_DESC,
	CAST(DATA.GL_KEY_CODE AS VARCHAR2(15)) AS GL_KEY_CODE,
	CAST(DATA.GL_KEY_CODE_DESC AS VARCHAR2(150)) AS GL_KEY_CODE_DESC,
	CAST(DATA.CONSOL_NODE AS VARCHAR2(20)) AS CONSOL_NODE,
	CAST(DATA.BUSINESS_UNIT AS VARCHAR2(5)) AS BUSINESS_UNIT,
	CAST(DATA.CURRENCY_CODE AS VARCHAR2(3)) AS CURRENCY_CODE,
	CAST(REPLACE(DATA.FOREIGN_AMOUNT, ',', '') AS NUMBER(23,3)) AS FOREIGN_AMOUNT,
	CAST(DATA.CURRENCY_USQ AS VARCHAR2(3)) AS CURRENCY_USQ,
	CAST(REPLACE(DATA.BASE_EQUIVALENT, ',', '') AS NUMBER(23,3)) AS BASE_EQUIVALENT,
	TO_DATE(DATA.ORIGINATION_DATE, 'MM/DD/YYYY') AS ORIGINATION_DATE,
	TO_DATE(DATA.MATURITY_DATE, 'MM/DD/YYYY') AS MATURITY_DATE,
	CAST(DATA.REMAINING_MATURITY_DAYS AS NUMBER(23,0)) AS REMAINING_MATURITY_DAYS,
	CAST(REPLACE(DATA.FRONTED_UNFUNDED_PARTICIPANTS, ',', '') AS NUMBER(23,3)) AS FRONTED_UNFUNDED_PARTICIPANTS,
	CAST(DATA.CUSTOMER_ID AS VARCHAR2(10)) AS CUSTOMER_ID,
	CAST(DATA.CUSTOMER_NAME AS VARCHAR2(50)) AS CUSTOMER_NAME,
	CAST(DATA."DEPO_NON-DEPO" AS VARCHAR2(25)) AS "DEPO_NON-DEPO",
	CAST(DATA.FOREIGN_DOMESTIC AS VARCHAR2(8)) AS FOREIGN_DOMESTIC,
	CAST(DATA.CANCELLABLE_Y_N AS VARCHAR2(50)) AS CANCELLABLE_Y_N,
	CAST(DATA.MATURITY_BUCKETS AS VARCHAR2(50)) AS MATURITY_BUCKETS,
	CAST(REPLACE(DATA.SECURITIZATION_EXPO, ',', '') AS NUMBER(23,3)) AS SECURITIZATION_EXPO,
	CAST(DATA.CREDIT_CONVERSION_FACTOR AS NUMBER(23,3)) AS CREDIT_CONVERSION_FACTOR,
	CAST(REPLACE(DATA.CREDIT_EQUIVALENT_AMT, ',', '') AS NUMBER(23,3)) AS CREDIT_EQUIVALENT_AMT,
	CAST(DATA.RISK_COUNTRY AS VARCHAR2(50)) AS RISK_COUNTRY,
	CAST(DATA.RISK_COUNTRY_CODE AS VARCHAR2(10)) AS RISK_COUNTRY_CODE,
	CAST(DATA.RISK_WEIGHTED_CATEGORY AS NUMBER(23,3)) AS RISK_WEIGHTED_CATEGORY,
	CAST(REPLACE(DATA.RISK_WEIGHTED_ALLOCATION, ',', '') AS NUMBER(23,3)) AS RISK_WEIGHTED_ALLOCATION,
	CAST(REPLACE(DATA.UMD_1, ',', '') AS NUMBER(23,3)) AS UMD_1,
	CAST(REPLACE(DATA.UMD_2, ',', '') AS NUMBER(23,3)) AS UMD_2,
	CAST(REPLACE(DATA.UMD_3, ',', '') AS NUMBER(23,3)) AS UMD_3,
	CAST(DATA.SECURED_Y_N AS VARCHAR2(25)) AS SECURED_Y_N,
	CAST(DATA.GUARANTEED_Y_N AS VARCHAR2(25)) AS GUARANTEED_Y_N,
	CAST(DATA.GOVT_GUARANTEED_PERCENTAGE  AS NUMBER(23,3)) AS GOVT_GUARANTEED_PERCENTAGE ,
	CAST(DATA.QUALIFIED_CENTRAL_CPT_Y_N AS VARCHAR2(25)) AS QUALIFIED_CENTRAL_CPT_Y_N,
	CAST(REPLACE(DATA.ABCP_CONDUITS_AMT, ',', '') AS NUMBER(28,3)) AS ABCP_CONDUITS_AMT,
	CAST(DATA.SOVERIGN_DEFAULT_Y_N AS VARCHAR2(25)) AS SOVERIGN_DEFAULT_Y_N,
	CAST(DATA.CRC_RATING_OF_OECD_EXPOSURES AS NUMBER(28,3)) AS CRC_RATING_OF_OECD_EXPOSURES,
	CAST(DATA.US_GAAP_RISK_RATING AS VARCHAR2(20)) AS US_GAAP_RISK_RATING,
	CAST(DATA.IFRS_RISK_RATING AS VARCHAR2(20)) AS IFRS_RISK_RATING,
	CAST(REPLACE(DATA.ACILITY_LIMIT_AMOUNT, ',', '') AS NUMBER(23,3)) AS FACILITY_LIMIT_AMOUNT,
	CAST(REPLACE(DATA.FACILITY_USED_AMOUNT, ',', '') AS NUMBER(23,3)) AS FACILITY_USED_AMOUNT,
	CAST(REPLACE(DATA.SYNDICATED_RABOSHARE, ',', '') AS NUMBER(23,3)) AS SYNDICATED_RABOSHARE,
	CAST(DATA."SYNDICATED_RABOSHARE_%" AS NUMBER(23,3)) AS "SYNDICATED_RABOSHARE_%",
	CAST(REPLACE(DATA.SYNDICATED_PARTICIPANTS, ',', '') AS NUMBER(23,3)) AS SYNDICATED_PARTICIPANTS,
	CAST(DATA."SYNDICATED_PARTICIPANTS_%" AS NUMBER(23,3)) AS "SYNDICATED_PARTICIPANTS_%",
	CAST(DATA.SOURCE AS VARCHAR2(4)) AS SOURCE,
	CAST(REPLACE(DATA.UMD_4, ',', '') AS VARCHAR2(250)) AS UMD_4,
	CAST(REPLACE(DATA.UMD_5, ',', '') AS VARCHAR2(250)) AS UMD_5,
	CAST(REPLACE(DATA.UMD_6, ',', '') AS VARCHAR2(250)) AS UMD_6,
	CAST(DATA.TRADE_ID AS VARCHAR2(20)) AS TRADE_ID,
	CAST(DATA.REPORTABLE_Y_N AS VARCHAR2(20)) AS REPORTABLE_Y_N,
	CAST(DATA.BU  AS VARCHAR2(10)) AS BU ,
	CAST(DATA.ACCOUNT AS VARCHAR2(10)) AS ACCOUNT,
	CAST(DATA.PRODUCT AS VARCHAR2(6)) AS PRODUCT,
	CAST(DATA.OPERATING_UNIT AS VARCHAR2(8)) AS OPERATING_UNIT,
	CAST(DATA.DEPTID AS VARCHAR2(15)) AS DEPTID,
	CAST(DATA.CUST_CLASS AS VARCHAR2(10)) AS CUST_CLASS,
	CAST(DATA.AFFILIATE AS VARCHAR2(5)) AS AFFILIATE,
	CAST(DATA.CIF_TYPE AS VARCHAR2(20)) AS CIF_TYPE,
	CAST(DATA.CUSTOMER_TYPE AS VARCHAR2(30)) AS CUSTOMER_TYPE,
	CAST(DATA.LOAN_CALL_CODE AS VARCHAR2(50)) AS LOAN_CALL_CODE,
	CAST(DATA.PRODUCT_GROUP AS VARCHAR2(50)) AS PRODUCT_GROUP,
	CAST(DATA.FACILITY_TYPE AS VARCHAR2(30)) AS FACILITY_TYPE,
	CAST(DATA.FACILITY_TYPE_DESC AS VARCHAR2(100)) AS FACILITY_TYPE_DESC,
	CAST(DATA.CALL_CODE_CODEBLOCK AS VARCHAR2(100)) AS CALL_CODE_CODEBLOCK,
	CAST(DATA.CCF_CODEBLOCK AS VARCHAR2(100)) AS CCF_CODEBLOCK,
	CAST(DATA.FILLER_1 AS VARCHAR2(250)) AS FILLER_1,
	CAST(DATA.FILLER_2 AS VARCHAR2(250)) AS FILLER_2,
	CAST(DATA.FILLER_3 AS VARCHAR2(250)) AS FILLER_3,
	CAST(DATA.FILLER_4 AS VARCHAR2(250)) AS FILLER_4,
	CAST(DATA.FILLER_5 AS VARCHAR2(250)) AS FILLER_5,
	CAST(DATA.FILLER_6 AS VARCHAR2(250)) AS FILLER_6,
	CAST(DATA.FILLER_7 AS VARCHAR2(250)) AS FILLER_7,
	CAST(DATA.FILLER_8 AS VARCHAR2(250)) AS FILLER_8,
	CAST(DATA.FILLER_9 AS VARCHAR2(250)) AS FILLER_9,
	CAST(DATA.FILLER_10 AS VARCHAR2(250)) AS FILLER_10,
	CAST(DATA.FILLER_11 AS VARCHAR2(250)) AS FILLER_11,
	CAST(DATA.FILLER_12 AS VARCHAR2(250)) AS FILLER_12,
	CAST(DATA.FILLER_13 AS VARCHAR2(250)) AS FILLER_13,
	CAST(DATA.FILLER_14 AS VARCHAR2(250)) AS FILLER_14,
	CAST(DATA.FILLER_15 AS VARCHAR2(250)) AS FILLER_15,
	CAST(DATA.FILLER_16 AS VARCHAR2(250)) AS FILLER_16,
	CAST(DATA.FILLER_17 AS VARCHAR2(250)) AS FILLER_17,
	CAST(DATA.FILLER_18 AS VARCHAR2(250)) AS FILLER_18,
	CAST(DATA.FILLER_19 AS VARCHAR2(250)) AS FILLER_19,
	CAST(DATA.FILLER_20 AS VARCHAR2(250)) AS FILLER_20,
	CAST(DATA.FILLER_21 AS VARCHAR2(250)) AS FILLER_21,
	CAST(DATA.FILLER_22 AS VARCHAR2(250)) AS FILLER_22,
	CAST(DATA.FILLER_23 AS VARCHAR2(250)) AS FILLER_23,
	CAST(DATA.FILLER_24 AS VARCHAR2(250)) AS FILLER_24,
	CAST(DATA.FILLER_25 AS VARCHAR2(250)) AS FILLER_25,
	DATA.PROVENIENZA,
	DATA.USERUPD,
	DATA.DATEUPD
FROM
  (
    SELECT DISTINCT
      MONTH_END_DATE,
      REPORTING_ENTITY,
      RB_ROWID
    FROM
      RB_STG_OFF_BS_01
  ) KEYS
  INNER JOIN
  (
    SELECT
        CAST('01' AS VARCHAR(2)) AS TGK_TABLE_SEGMENT,
        RB_ROWID,
		MONTH_END_DATE,
		REPORTING_ENTITY,
		INSTRUMENT,
		CALL_CODE,
		CALL_CODE_DESC,
		GL_KEY_CODE,
		GL_KEY_CODE_DESC,
		CONSOL_NODE,
		BUSINESS_UNIT,
		CURRENCY_CODE,
		FOREIGN_AMOUNT,
		CURRENCY_USQ,
		BASE_EQUIVALENT,
		ORIGINATION_DATE,
		MATURITY_DATE,
		REMAINING_MATURITY_DAYS,
		FRONTED_UNFUNDED_PARTICIPANTS,
		CUSTOMER_ID,
		CUSTOMER_NAME,
		"DEPO_NON-DEPO",
		FOREIGN_DOMESTIC,
		CANCELLABLE_Y_N,
		MATURITY_BUCKETS,
		SECURITIZATION_EXPO,
		CREDIT_CONVERSION_FACTOR,
		CREDIT_EQUIVALENT_AMT,
		RISK_COUNTRY,
		RISK_COUNTRY_CODE,
		RISK_WEIGHTED_CATEGORY,
		RISK_WEIGHTED_ALLOCATION,
		UMD_1,
		UMD_2,
		UMD_3,
		SECURED_Y_N,
		GUARANTEED_Y_N,
		GOVT_GUARANTEED_PERCENTAGE ,
		QUALIFIED_CENTRAL_CPT_Y_N,
		ABCP_CONDUITS_AMT,
		SOVERIGN_DEFAULT_Y_N,
		CRC_RATING_OF_OECD_EXPOSURES,
		US_GAAP_RISK_RATING,
		IFRS_RISK_RATING,
		FACILITY_LIMIT_AMOUNT,
		FACILITY_USED_AMOUNT,
		SYNDICATED_RABOSHARE,
		"SYNDICATED_RABOSHARE_%",
		SYNDICATED_PARTICIPANTS,
		"SYNDICATED_PARTICIPANTS_%",
		SOURCE,
		UMD_4,
		UMD_5,
		UMD_6,
		TRADE_ID,
		REPORTABLE_Y_N,
		BU,
		ACCOUNT,
		PRODUCT,
		OPERATING_UNIT,
		DEPTID,
		CUST_CLASS,
		AFFILIATE,
		CIF_TYPE,
		CUSTOMER_TYPE,
		LOAN_CALL_CODE,
		PRODUCT_GROUP,
		FACILITY_TYPE,
		FACILITY_TYPE_DESC,
		CALL_CODE_CODEBLOCK,
		CCF_CODEBLOCK,
		FILLER_1,
		FILLER_2,
		FILLER_3,
		FILLER_4,
		FILLER_5,
		FILLER_6,
		FILLER_7,
		FILLER_8,
		FILLER_9,
		FILLER_10,
		FILLER_11,
		FILLER_12,
		FILLER_13,
		FILLER_14,
		FILLER_15,
		FILLER_16,
		FILLER_17,
		FILLER_18,
		FILLER_19,
		FILLER_20,
		FILLER_21,
		FILLER_22,
		FILLER_23,
		FILLER_24,
		FILLER_25,
        PROVENIENZA,
        USERUPD,
        DATEUPD
    FROM
      RB_STG_OFF_BS_01
  ) DATA
  ON
    KEYS.MONTH_END_DATE = DATA.MONTH_END_DATE
    AND KEYS.REPORTING_ENTITY = DATA.REPORTING_ENTITY
    AND KEYS.RB_ROWID = DATA.RB_ROWID
;