--------------------------------------------------------
--  DDL for View RB_V_HST_OREO
--------------------------------------------------------

  CREATE OR REPLACE FORCE VIEW "RB_V_HST_OREO" (
"RB_ROWID",
"MONTH_END_DATE",
"REPORTING_ENTITY",
"INTERCOMPANY",
"CONSOL_NODE",
"BUSINESS_UNIT",
"GL_KEY_CODE",
"GL_KEY_CODE_DESC",
"CALL_CODE",
"CALL_CODE_DESC",
"LOAN_NUMBER",
"INSTRUMENT_ID",
"CONVERTED_INSTRUMENT_ID",
"CALL_CODE_LOOKUP",
"CURRENT_OREO_ASSET_NUMBER",
"ENTITY_CHANGE",
"DUPLICATE_LOAN_ON_ONE_PROPERTY",
"FORECLOSURE_INDICATOR_DESCRPTN",
"OREO_NEW_OREO_EVENT",
"OREO_COST_CENTER",
"OREO_INDICATOR",
"OREO_NET_LIDQUIDATION_PROCEEDS",
"OREO_NET_LIDQUIDATION_AMT",
"OREO_SALE_DATE",
"OREO_OFFSET_TO_CHARGE_OFF",
"OREO_OPER_EXP_CLOSING_STMT",
"OREO_VALUATION_ADJUSTMENT",
"OREO_FINAL_SALE",
"OREO_EVENT_DATE",
"OREO_APPRAISAL_VALUE",
"OREO_APPRAISAL_DATE",
"OREO_CURRENT_BAL_ACCUMULATOR",
"OREO_LOSS_ON_SALE",
"OREO_PROJCTED_LIQUIDATION_DATE",
"OREO_LOAN_PRIN_BAL_PRPTY_REV",
"OREO_BEG_BAL_AT_CURRENT_YEAR",
"OREO_NOTES",
"OREO_COMPANY",
"FORECLOSURE_START_DATE",
"FORECLOSURE_SALE_DATE",
"LOSS_SHARE_VALUE",
"MATURITY_DATE",
"MATURITY_BUCKETS",
"LOSS_SHARING_AGREEMENT_YN",
"SPV_YN",
"ABCP_CONDUITS_YN",
"VIE_YN",
"REGULATORY_RISK_RATINGS",
"LEVEL_FAIR_VALUE",
"ACCOUNT",
"PRODUCT",
"OPERATING_UNIT",
"AFFILIATE",
"CUST_CLASS",
"UMD1",
"UMD2",
"UMD3",
"UMD4",
"UMD5",
"FILLER_1",
"FILLER_2",
"FILLER_3",
"FILLER_4",
"FILLER_5",
"FILLER_6",
"FILLER_7",
"FILLER_8",
"FILLER_9",
"FILLER_10",
"FILLER_11",
"FILLER_12",
"FILLER_13",
"FILLER_14",
"FILLER_15",
"FILLER_16",
"FILLER_17",
"FILLER_18",
"FILLER_19",
"FILLER_20",
"FILLER_21",
"FILLER_22",
"FILLER_23",
"FILLER_24",
"FILLER_25",
PROVENIENZA,
USERUPD,
DATEUPD
) AS 
  SELECT
CAST(KEYS."RB_ROWID" AS NUMBER) AS "RB_ROWID",
TO_DATE(KEYS."MONTH_END_DATE", 'MMDDYYYY') AS "MONTH_END_DATE",
CAST(KEYS."REPORTING_ENTITY" AS VARCHAR2(6)) AS "REPORTING_ENTITY",
CAST(DATA01."INTERCOMPANY" AS VARCHAR2(15)) AS "INTERCOMPANY",
CAST(DATA01."CONSOL_NODE" AS VARCHAR2(20)) AS "CONSOL_NODE",
CAST(DATA01."BUSINESS_UNIT" AS VARCHAR2(5)) AS "BUSINESS_UNIT",
CAST(DATA01."GL_KEY_CODE" AS VARCHAR2(15)) AS "GL_KEY_CODE",
CAST(DATA01."GL_KEY_CODE_DESC" AS VARCHAR2(150)) AS "GL_KEY_CODE_DESC",
CAST(DATA01."CALL_CODE" AS VARCHAR2(15)) AS "CALL_CODE",
CAST(DATA01."CALL_CODE_DESC" AS VARCHAR2(150)) AS "CALL_CODE_DESC",
CAST(DATA01."LOAN_NUMBER" AS VARCHAR2(15)) AS "LOAN_NUMBER",
CAST(DATA01."INSTRUMENT_ID" AS VARCHAR2(27)) AS "INSTRUMENT_ID",
CAST(DATA01."CONVERTED_INSTRUMENT_ID" AS VARCHAR2(27)) AS "CONVERTED_INSTRUMENT_ID",
CAST(DATA01."CALL_CODE_LOOKUP" AS VARCHAR2(5)) AS "CALL_CODE_LOOKUP",
CAST(DATA01."CURRENT_OREO_ASSET_NUMBER" AS VARCHAR2(250)) AS "CURRENT_OREO_ASSET_NUMBER",
CAST(DATA01."ENTITY_CHANGE" AS VARCHAR2(3)) AS "ENTITY_CHANGE",
CAST(DATA01."DUPLICATE_LOAN_ON_ONE_PROPERTY" AS VARCHAR2(3)) AS "DUPLICATE_LOAN_ON_ONE_PROPERTY",
CAST(DATA01."FORECLOSURE_INDICATOR_DESCRPTN" AS VARCHAR2(250)) AS "FORECLOSURE_INDICATOR_DESCRPTN",
CAST(DATA01."OREO_NEW_OREO_EVENT" AS VARCHAR2(3)) AS "OREO_NEW_OREO_EVENT",
CAST(DATA01."OREO_COST_CENTER" AS VARCHAR2(15)) AS "OREO_COST_CENTER",
CAST(DATA01."OREO_INDICATOR" AS VARCHAR2(3)) AS "OREO_INDICATOR",
CAST(REPLACE(DATA01."OREO_NET_LIDQUIDATION_PROCEEDS", ',', '') AS NUMBER(23,3)) AS "OREO_NET_LIDQUIDATION_PROCEEDS",
CAST(REPLACE(DATA01."OREO_NET_LIDQUIDATION_AMT", ',', '') AS NUMBER(23,3)) AS "OREO_NET_LIDQUIDATION_AMT",
TO_DATE(DATA01."OREO_SALE_DATE", 'MMDDYYYY') AS "OREO_SALE_DATE",
CAST(REPLACE(DATA01."OREO_OFFSET_TO_CHARGE_OFF", ',', '') AS NUMBER(23,3)) AS "OREO_OFFSET_TO_CHARGE_OFF",
CAST(REPLACE(DATA01."OREO_OPER_EXP_CLOSING_STMT", ',', '') AS NUMBER(23,3)) AS "OREO_OPER_EXP_CLOSING_STMT",
CAST(REPLACE(DATA01."OREO_VALUATION_ADJUSTMENT", ',', '') AS NUMBER(23,3)) AS "OREO_VALUATION_ADJUSTMENT",
CAST(REPLACE(DATA01."OREO_FINAL_SALE", ',', '') AS NUMBER(23,3)) AS "OREO_FINAL_SALE",
TO_DATE(DATA01."OREO_EVENT_DATE", 'MMDDYYYY') AS "OREO_EVENT_DATE",
CAST(REPLACE(DATA01."OREO_APPRAISAL_VALUE", ',', '') AS NUMBER(23,3)) AS "OREO_APPRAISAL_VALUE",
TO_DATE(DATA01."OREO_APPRAISAL_DATE", 'MMDDYYYY') AS "OREO_APPRAISAL_DATE",
CAST(REPLACE(DATA01."OREO_CURRENT_BAL_ACCUMULATOR", ',', '') AS NUMBER(23,3)) AS "OREO_CURRENT_BAL_ACCUMULATOR",
CAST(REPLACE(DATA01."OREO_LOSS_ON_SALE", ',', '') AS NUMBER(23,3)) AS "OREO_LOSS_ON_SALE",
TO_DATE(DATA01."OREO_PROJCTED_LIQUIDATION_DATE", 'MMDDYYYY') AS "OREO_PROJCTED_LIQUIDATION_DATE",
CAST(REPLACE(DATA01."OREO_LOAN_PRIN_BAL_PRPTY_REV", ',', '') AS NUMBER(23,3)) AS "OREO_LOAN_PRIN_BAL_PRPTY_REV",
CAST(REPLACE(DATA01."OREO_BEG_BAL_AT_CURRENT_YEAR", ',', '') AS NUMBER(23,3)) AS "OREO_BEG_BAL_AT_CURRENT_YEAR",
CAST(DATA01."OREO_NOTES" AS VARCHAR2(250)) AS "OREO_NOTES",
CAST(DATA01."OREO_COMPANY" AS VARCHAR2(5)) AS "OREO_COMPANY",
TO_DATE(DATA01."FORECLOSURE_START_DATE", 'MMDDYYYY') AS "FORECLOSURE_START_DATE",
TO_DATE(DATA01."FORECLOSURE_SALE_DATE", 'MMDDYYYY') AS "FORECLOSURE_SALE_DATE",
CAST(REPLACE(DATA01."LOSS_SHARE_VALUE", ',', '') AS NUMBER(23,3)) AS "LOSS_SHARE_VALUE",
TO_DATE(DATA01."MATURITY_DATE", 'MMDDYYYY') AS "MATURITY_DATE",
CAST(DATA01."MATURITY_BUCKETS" AS VARCHAR2(20)) AS "MATURITY_BUCKETS",
CAST(DATA01."LOSS_SHARING_AGREEMENT_YN" AS VARCHAR2(3)) AS "LOSS_SHARING_AGREEMENT_YN",
CAST(DATA01."SPV_YN" AS VARCHAR2(3)) AS "SPV_YN",
CAST(DATA01."ABCP_CONDUITS_YN" AS VARCHAR2(3)) AS "ABCP_CONDUITS_YN",
CAST(DATA01."VIE_YN" AS VARCHAR2(3)) AS "VIE_YN",
CAST(REPLACE(DATA01."REGULATORY_RISK_RATINGS", 'N', '') AS NUMBER(3,3)) AS "REGULATORY_RISK_RATINGS",
CAST(DATA01."LEVEL_FAIR_VALUE" AS VARCHAR2(10)) AS "LEVEL_FAIR_VALUE",
CAST(DATA01."ACCOUNT" AS VARCHAR2(10)) AS "ACCOUNT",
CAST(DATA01."PRODUCT" AS VARCHAR2(6)) AS "PRODUCT",
CAST(DATA01."OPERATING_UNIT" AS VARCHAR2(8)) AS "OPERATING_UNIT",
CAST(DATA01."AFFILIATE" AS VARCHAR2(5)) AS "AFFILIATE",
CAST(DATA01."CUST_CLASS" AS VARCHAR2(10)) AS "CUST_CLASS",
CAST(DATA01."UMD1" AS VARCHAR2(250)) AS "UMD1",
CAST(DATA01."UMD2" AS VARCHAR2(250)) AS "UMD2",
CAST(DATA01."UMD3" AS VARCHAR2(250)) AS "UMD3",
CAST(DATA01."UMD4" AS VARCHAR2(250)) AS "UMD4",
CAST(DATA01."UMD5" AS VARCHAR2(250)) AS "UMD5",
CAST(DATA01."FILLER_1" AS VARCHAR2(250)) AS "FILLER_1",
CAST(DATA01."FILLER_2" AS VARCHAR2(250)) AS "FILLER_2",
CAST(DATA01."FILLER_3" AS VARCHAR2(250)) AS "FILLER_3",
CAST(DATA01."FILLER_4" AS VARCHAR2(250)) AS "FILLER_4",
CAST(DATA01."FILLER_5" AS VARCHAR2(250)) AS "FILLER_5",
CAST(DATA01."FILLER_6" AS VARCHAR2(250)) AS "FILLER_6",
CAST(DATA01."FILLER_7" AS VARCHAR2(250)) AS "FILLER_7",
CAST(DATA01."FILLER_8" AS VARCHAR2(250)) AS "FILLER_8",
CAST(DATA01."FILLER_9" AS VARCHAR2(250)) AS "FILLER_9",
CAST(DATA01."FILLER_10" AS VARCHAR2(250)) AS "FILLER_10",
CAST(DATA01."FILLER_11" AS VARCHAR2(250)) AS "FILLER_11",
CAST(DATA01."FILLER_12" AS VARCHAR2(250)) AS "FILLER_12",
CAST(DATA01."FILLER_13" AS VARCHAR2(250)) AS "FILLER_13",
CAST(DATA01."FILLER_14" AS VARCHAR2(250)) AS "FILLER_14",
CAST(DATA01."FILLER_15" AS VARCHAR2(250)) AS "FILLER_15",
CAST(DATA01."FILLER_16" AS VARCHAR2(250)) AS "FILLER_16",
CAST(DATA01."FILLER_17" AS VARCHAR2(250)) AS "FILLER_17",
CAST(DATA01."FILLER_18" AS VARCHAR2(250)) AS "FILLER_18",
CAST(DATA01."FILLER_19" AS VARCHAR2(250)) AS "FILLER_19",
CAST(DATA01."FILLER_20" AS VARCHAR2(250)) AS "FILLER_20",
CAST(DATA01."FILLER_21" AS VARCHAR2(250)) AS "FILLER_21",
CAST(DATA01."FILLER_22" AS VARCHAR2(250)) AS "FILLER_22",
CAST(DATA01."FILLER_23" AS VARCHAR2(250)) AS "FILLER_23",
CAST(DATA01."FILLER_24" AS VARCHAR2(250)) AS "FILLER_24",
CAST(DATA01."FILLER_25" AS VARCHAR2(250)) AS "FILLER_25",
DATA01."PROVENIENZA",
KEYS."USERUPD",
DATA01."DATEUPD"
FROM
  (
    SELECT DISTINCT
RB_ROWID,
MONTH_END_DATE,
REPORTING_ENTITY,
USERUPD
    FROM
      RB_STG_OREO_01
  ) KEYS
INNER JOIN
  (
    SELECT
"INTERCOMPANY",
"CONSOL_NODE",
"BUSINESS_UNIT",
"GL_KEY_CODE",
"GL_KEY_CODE_DESC",
"CALL_CODE",
"CALL_CODE_DESC",
"LOAN_NUMBER",
"INSTRUMENT_ID",
"CONVERTED_INSTRUMENT_ID",
"CALL_CODE_LOOKUP",
"CURRENT_OREO_ASSET_NUMBER",
"ENTITY_CHANGE",
"DUPLICATE_LOAN_ON_ONE_PROPERTY",
"FORECLOSURE_INDICATOR_DESCRPTN",
"OREO_NEW_OREO_EVENT",
"OREO_COST_CENTER",
"OREO_INDICATOR",
"OREO_NET_LIDQUIDATION_PROCEEDS",
"OREO_NET_LIDQUIDATION_AMT",
"OREO_SALE_DATE",
"OREO_OFFSET_TO_CHARGE_OFF",
"OREO_OPER_EXP_CLOSING_STMT",
"OREO_VALUATION_ADJUSTMENT",
"OREO_FINAL_SALE",
"OREO_EVENT_DATE",
"OREO_APPRAISAL_VALUE",
"OREO_APPRAISAL_DATE",
"OREO_CURRENT_BAL_ACCUMULATOR",
"OREO_LOSS_ON_SALE",
"OREO_PROJCTED_LIQUIDATION_DATE",
"OREO_LOAN_PRIN_BAL_PRPTY_REV",
"OREO_BEG_BAL_AT_CURRENT_YEAR",
"OREO_NOTES",
"OREO_COMPANY",
"FORECLOSURE_START_DATE",
"FORECLOSURE_SALE_DATE",
"LOSS_SHARE_VALUE",
"MATURITY_DATE",
"MATURITY_BUCKETS",
"LOSS_SHARING_AGREEMENT_YN",
"SPV_YN",
"ABCP_CONDUITS_YN",
"VIE_YN",
"REGULATORY_RISK_RATINGS",
"LEVEL_FAIR_VALUE",
"ACCOUNT",
"PRODUCT",
"OPERATING_UNIT",
"AFFILIATE",
"CUST_CLASS",
"UMD1",
"UMD2",
"UMD3",
"UMD4",
"UMD5",
"FILLER_1",
"FILLER_2",
"FILLER_3",
"FILLER_4",
"FILLER_5",
"FILLER_6",
"FILLER_7",
"FILLER_8",
"FILLER_9",
"FILLER_10",
"FILLER_11",
"FILLER_12",
"FILLER_13",
"FILLER_14",
"FILLER_15",
"FILLER_16",
"FILLER_17",
"FILLER_18",
"FILLER_19",
"FILLER_20",
"FILLER_21",
"FILLER_22",
"FILLER_23",
"FILLER_24",
"FILLER_25",
"RB_ROWID",
"MONTH_END_DATE",
"REPORTING_ENTITY",
"PROVENIENZA",
"USERUPD",
"DATEUPD"
FROM
RB_STG_OREO_01
  ) DATA01
  ON
KEYS.RB_ROWID = DATA01.RB_ROWID AND
KEYS.MONTH_END_DATE = DATA01.MONTH_END_DATE AND
KEYS.REPORTING_ENTITY = DATA01.REPORTING_ENTITY AND
KEYS.USERUPD = DATA01.USERUPD