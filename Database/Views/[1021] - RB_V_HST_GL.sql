--------------------------------------------------------
--  DDL for View RB_V_HST_GL
--------------------------------------------------------

CREATE OR REPLACE NOFORCE VIEW "RB_V_HST_GL" (
	RB_ROWID,
	REPORTING_ENTITY,
	TGK_TABLE_SEGMENT,
	GL_KEY_CODE,
	CONSOL_NODE,
	BUSINESS_UNIT,
	OPERATING_UNIT,
	RB_BALANCE_TYPE,
	SOURCE,
	FISCAL_YEAR,
	BASE_CURRENCY,
	JAN_BASE,
	FEB_BASE,
	MAR_BASE,
	APR_BASE,
	MAY_BASE,
	JUNE_BASE,
	JULY_BASE,
	AUG_BASE,
	SEP_BASE,
	OCT_BASE,
	NOV_BASE,
	DEC_BASE,
	CURRENCY_CODE,
	JAN_ORIG,
	FEB_ORIG,
	MAR_ORIG,
	APR_ORIG,
	MAY_ORIG,
	JUNE_ORIG,
	JULY_ORIG,
	AUG_ORIG,
	SEP_ORIG,
	OCT_ORIG,
	NOV_ORIG,
	DEC_ORIG,
	ACCOUNT,
	DEPTID,
	PRODUCT,
	CUST_CLASS,
	AFFILIATE,
	OBU_AFFILIATE,
	PROJECT_ID,
  US_COA_ACCOUNT,
	PROVENIENZA,
	USERUPD,
	DATEUPD
) AS 
SELECT
	CAST(KEYS.RB_ROWID AS INT) AS RB_ROWID,
	CAST(KEYS.REPORTING_ENTITY AS VARCHAR(6)) AS REPORTING_ENTITY,
	CAST(DATA.TGK_TABLE_SEGMENT AS VARCHAR(2)) AS TGK_TABLE_SEGMENT,
	CAST(DATA.GL_KEY_CODE AS VARCHAR2(15)) AS GL_KEY_CODE,
	CAST(DATA.CONSOL_NODE AS VARCHAR2(20)) AS CONSOL_NODE,
	CAST(DATA.BUSINESS_UNIT AS VARCHAR2(5)) AS BUSINESS_UNIT,
	CAST(DATA.OPERATING_UNIT AS VARCHAR2(8)) AS OPERATING_UNIT,
	CAST(DATA.RB_BALANCE_TYPE AS VARCHAR2(6)) AS RB_BALANCE_TYPE,
	CAST(DATA.SOURCE AS VARCHAR2(4)) AS SOURCE,
	CAST(DATA.FISCAL_YEAR AS NUMBER(4)) AS FISCAL_YEAR,
	CAST(DATA.BASE_CURRENCY AS VARCHAR2(3)) AS BASE_CURRENCY,
	CAST(JAN_BASE AS NUMBER(26,3)) AS JAN_BASE,
	CAST(FEB_BASE AS NUMBER(26,3)) AS FEB_BASE,
	CAST(MAR_BASE AS NUMBER(26,3)) AS MAR_BASE,
	CAST(APR_BASE AS NUMBER(26,3)) AS APR_BASE,
	CAST(MAY_BASE AS NUMBER(26,3)) AS MAY_BASE,
	CAST(DATA.JUNE_BASE AS NUMBER(26,3)) AS JUNE_BASE,
	CAST(DATA.JULY_BASE AS NUMBER(26,3)) AS JULY_BASE,
	CAST(DATA.AUG_BASE AS NUMBER(26,3)) AS AUG_BASE,
	CAST(DATA.SEP_BASE AS NUMBER(26,3)) AS SEP_BASE,
	CAST(DATA.OCT_BASE AS NUMBER(26,3)) AS OCT_BASE,
	CAST(DATA.NOV_BASE AS NUMBER(26,3)) AS NOV_BASE,
	CAST(DATA.DEC_BASE AS NUMBER(26,3)) AS DEC_BASE,
	CAST(DATA.CURRENCY_CODE AS VARCHAR2(3)) AS CURRENCY_CODE,
	CAST(DATA.JAN_ORIG AS NUMBER(26,3)) AS JAN_ORIG,
	CAST(DATA.FEB_ORIG AS NUMBER(26,3)) AS FEB_ORIG,
	CAST(DATA.MAR_ORIG AS NUMBER(26,3)) AS MAR_ORIG,
	CAST(DATA.APR_ORIG AS NUMBER(26,3)) AS APR_ORIG,
	CAST(DATA.MAY_ORIG AS NUMBER(26,3)) AS MAY_ORIG,
	CAST(DATA.JUNE_ORIG AS NUMBER(26,3)) AS JUNE_ORIG,
	CAST(DATA.JULY_ORIG AS NUMBER(26,3)) AS JULY_ORIG,
	CAST(DATA.AUG_ORIG AS NUMBER(26,3)) AS AUG_ORIG,
	CAST(DATA.SEP_ORIG AS NUMBER(26,3)) AS SEP_ORIG,
	CAST(DATA.OCT_ORIG AS NUMBER(26,3)) AS OCT_ORIG,
	CAST(DATA.NOV_ORIG AS NUMBER(26,3)) AS NOV_ORIG,
	CAST(DATA.DEC_ORIG AS NUMBER(26,3)) AS DEC_ORIG,
	CAST(DATA.ACCOUNT AS VARCHAR2(10)) AS ACCOUNT,
	CAST(DATA.DEPTID AS VARCHAR2(10)) AS DEPTID,
	CAST(DATA.PRODUCT AS VARCHAR2(6)) AS PRODUCT,
	CAST(DATA.CUST_CLASS AS VARCHAR2(10)) AS CUST_CLASS,
	CAST(DATA.AFFILIATE AS VARCHAR2(5)) AS AFFILIATE,
	CAST(DATA.OBU_AFFILIATE AS VARCHAR2(10)) AS OBU_AFFILIATE,
	CAST(DATA.PROJECT_ID AS VARCHAR2(15)) AS PROJECT_ID,
  CAST(DATA.US_COA_ACCOUNT AS VARCHAR2(30)) AS US_COA_ACCOUNT,
	DATA.PROVENIENZA,
	DATA.USERUPD,
	DATA.DATEUPD
FROM
  (
    SELECT DISTINCT
		FISCAL_YEAR,
		RB_ROWID,
		REPORTING_ENTITY
    FROM
      RB_STG_GL_01
  ) KEYS
  INNER JOIN
  (
    SELECT
        CAST('01' AS VARCHAR(2)) AS TGK_TABLE_SEGMENT,
        RB_ROWID,
		REPORTING_ENTITY,
		GL_KEY_CODE,
		CONSOL_NODE,
		BUSINESS_UNIT,
		OPERATING_UNIT,
		RB_BALANCE_TYPE,
		SOURCE,
		FISCAL_YEAR,
		BASE_CURRENCY,
		JAN_BASE,
		FEB_BASE,
		MAR_BASE,
		APR_BASE,
		MAY_BASE,
		JUNE_BASE,
		JULY_BASE,
		AUG_BASE,
		SEP_BASE,
		OCT_BASE,
		NOV_BASE,
		DEC_BASE,
		CURRENCY_CODE,
		JAN_ORIG,
		FEB_ORIG,
		MAR_ORIG,
		APR_ORIG,
		MAY_ORIG,
		JUNE_ORIG,
		JULY_ORIG,
		AUG_ORIG,
		SEP_ORIG,
		OCT_ORIG,
		NOV_ORIG,
		DEC_ORIG,
		ACCOUNT,
		DEPTID,
		PRODUCT,
		CUST_CLASS,
		AFFILIATE,
		OBU_AFFILIATE,
		PROJECT_ID,
    US_COA_ACCOUNT,
        PROVENIENZA,
        USERUPD,
        DATEUPD
    FROM
      RB_STG_GL_01
  ) DATA
  ON
	KEYS.FISCAL_YEAR = DATA.FISCAL_YEAR
	AND KEYS.RB_ROWID = DATA.RB_ROWID
	AND KEYS.REPORTING_ENTITY = DATA.REPORTING_ENTITY
;