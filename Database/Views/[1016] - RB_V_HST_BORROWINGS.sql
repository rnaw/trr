--------------------------------------------------------
--  DDL for View RB_V_HST_BORROWINGS
--------------------------------------------------------

CREATE OR REPLACE NOFORCE VIEW "RB_V_HST_BORROWINGS" (
	RB_ROWID,
	MONTH_END_DATE,
	REPORTING_ENTITY,
	INSTRUMENT,
	INTERCOMPANY,
	CALL_CODE,
	CALL_CODE_DESC,
	GL_KEY_CODE,
	GL_KEY_CODE_DESC,
	CONSOL_NODE,
	BUSINESS_UNIT,
	CURRENCY_CODE,
	FOREIGN_AMOUNT,
	CURRENCY_USQ,
	BASE_EQUIVALENT,
	MATURITY_DATE,
	REMAINING_MATURITY_DAYS,
	MATURITY_BUCKETS,
	MATURITY_BUCKETS_2,
	CUSTOMER_ID,
	"DEPO_NON-DEPO",
	FOREIGN_DOMESTIC,
	PRINCIPAL_ORIG_CCY,
	DISCOUNT_GIVEN_ORIG_CCY,
	OVERDRAFT_CASH_ORIG_CCY,
	PRINCIPAL_BASE_EQ,
	DISCOUNT_GIVEN_BASE_EQ,
	OVERDRAFT_CASH_BASE_EQ,
	PROD_TYPE_DESC,
	CUSTOMER_TYPE,
	UMD_1,
	SOURCE,
	UMD_2,
	UMD_3,
	UMD_4,
	TRADE_ID,
	REPORTABLE_Y_N,
	BU,
	ACCOUNT,
	PRODUCT,
	OPERATING_UNIT,
	DEPTID,
	CUST_CLASS,
	AFFILIATE,
	CIF_TYPE,
	CIF_TYPE_DESCRIPTION,
	DISC_GIVEN_CALL_CODE_CODEBLOCK,
	OVRDRFT_CASH_CALL_CODE_CODEBLK,
	FILLER_1,
	FILLER_2,
	FILLER_3,
	FILLER_4,
	FILLER_5,
	FILLER_6,
	FILLER_7,
	FILLER_8,
	FILLER_9,
	FILLER_10,
	FILLER_11,
	FILLER_12,
	FILLER_13,
	FILLER_14,
	FILLER_15,
	FILLER_16,
	FILLER_17,
	FILLER_18,
	FILLER_19,
	FILLER_20,
	FILLER_21,
	FILLER_22,
	FILLER_23,
	FILLER_24,
	FILLER_25,
	PROVENIENZA,
	USERUPD,
	DATEUPD
) AS 
SELECT
	CAST(KEYS.RB_ROWID AS NUMBER(38,0)) AS RB_ROWID,
	TO_DATE(KEYS.MONTH_END_DATE, 'MMDDYYYY') AS MONTH_END_DATE,
	CAST(KEYS.REPORTING_ENTITY AS VARCHAR2(6)) AS REPORTING_ENTITY,
	CAST(INSTRUMENT AS VARCHAR2(27)) AS INSTRUMENT,
	CAST(INTERCOMPANY AS VARCHAR2(15)) AS INTERCOMPANY,
	CAST(CALL_CODE AS VARCHAR2(15)) AS CALL_CODE,
	CAST(CALL_CODE_DESC AS VARCHAR2(150)) AS CALL_CODE_DESC,
	CAST(GL_KEY_CODE AS VARCHAR2(15)) AS GL_KEY_CODE,
	CAST(GL_KEY_CODE_DESC AS VARCHAR2(150)) AS GL_KEY_CODE_DESC,
	CAST(CONSOL_NODE AS VARCHAR2(20)) AS CONSOL_NODE,
	CAST(BUSINESS_UNIT AS VARCHAR2(5)) AS BUSINESS_UNIT,
	CAST(CURRENCY_CODE AS VARCHAR2(3)) AS CURRENCY_CODE,
	CAST(FOREIGN_AMOUNT AS NUMBER(23,3)) AS FOREIGN_AMOUNT,
	CAST(CURRENCY_USQ AS VARCHAR2(3)) AS CURRENCY_USQ,
	CAST(BASE_EQUIVALENT AS NUMBER(23,3)) AS BASE_EQUIVALENT,
	TO_DATE(MATURITY_DATE, 'MM/DD/YYYY') AS MATURITY_DATE,
	CAST(REMAINING_MATURITY_DAYS AS NUMBER(23,0)) AS REMAINING_MATURITY_DAYS,
	CAST(MATURITY_BUCKETS AS VARCHAR2(50)) AS MATURITY_BUCKETS,
	CAST(MATURITY_BUCKETS_2 AS VARCHAR2(50)) AS MATURITY_BUCKETS_2,
	CAST(CUSTOMER_ID AS VARCHAR2(10)) AS CUSTOMER_ID,
	CAST("DEPO_NON-DEPO" AS VARCHAR2(25)) AS "DEPO_NON-DEPO",
	CAST(FOREIGN_DOMESTIC AS VARCHAR2(8)) AS FOREIGN_DOMESTIC,
	CAST(PRINCIPAL_ORIG_CCY AS NUMBER(23,3)) AS PRINCIPAL_ORIG_CCY,
	CAST(DISCOUNT_GIVEN_ORIG_CCY AS NUMBER(23,3)) AS DISCOUNT_GIVEN_ORIG_CCY,
	CAST(OVERDRAFT_CASH_ORIG_CCY AS NUMBER(23,3)) AS OVERDRAFT_CASH_ORIG_CCY,
	CAST(PRINCIPAL_BASE_EQ AS NUMBER(23,3)) AS PRINCIPAL_BASE_EQ,
	CAST(DISCOUNT_GIVEN_BASE_EQ AS NUMBER(23,3)) AS DISCOUNT_GIVEN_BASE_EQ,
	CAST(OVERDRAFT_CASH_BASE_EQ AS NUMBER(23,3)) AS OVERDRAFT_CASH_BASE_EQ,
	CAST(PROD_TYPE_DESC AS VARCHAR2(100)) AS PROD_TYPE_DESC,
	CAST(CUSTOMER_TYPE AS VARCHAR2(30)) AS CUSTOMER_TYPE,
	CAST(UMD_1 AS NUMBER(23,3)) AS UMD_1,
	CAST(SOURCE AS VARCHAR2(4)) AS SOURCE,
	CAST(UMD_2 AS NUMBER(23,3)) AS UMD_2,
	CAST(UMD_3 AS NUMBER(23,3)) AS UMD_3,
	CAST(UMD_4 AS NUMBER(23,3)) AS UMD_4,
	CAST(TRADE_ID AS VARCHAR2(20)) AS TRADE_ID,
	CAST(REPORTABLE_Y_N AS VARCHAR2(10)) AS REPORTABLE_Y_N,
	CAST(BU AS VARCHAR2(10)) AS BU,
	CAST(ACCOUNT AS VARCHAR2(10)) AS ACCOUNT,
	CAST(PRODUCT AS VARCHAR2(10)) AS PRODUCT,
	CAST(OPERATING_UNIT AS VARCHAR2(10)) AS OPERATING_UNIT,
	CAST(DEPTID AS VARCHAR2(15)) AS DEPTID,
	CAST(CUST_CLASS AS VARCHAR2(10)) AS CUST_CLASS,
	CAST(AFFILIATE AS VARCHAR2(10)) AS AFFILIATE,
	CAST(CIF_TYPE AS VARCHAR2(20)) AS CIF_TYPE,
	CAST(CIF_TYPE_DESCRIPTION AS VARCHAR2(50)) AS CIF_TYPE_DESCRIPTION,
	CAST(DISC_GIVEN_CALL_CODE_CODEBLOCK AS VARCHAR2(100)) AS DISC_GIVEN_CALL_CODE_CODEBLOCK,
	CAST(OVRDRFT_CASH_CALL_CODE_CODEBLK AS VARCHAR2(100)) AS OVRDRFT_CASH_CALL_CODE_CODEBLK,
	CAST(FILLER_1 AS VARCHAR2(250)) AS FILLER_1,
	CAST(FILLER_2 AS VARCHAR2(250)) AS FILLER_2,
	CAST(FILLER_3 AS VARCHAR2(250)) AS FILLER_3,
	CAST(FILLER_4 AS VARCHAR2(250)) AS FILLER_4,
	CAST(FILLER_5 AS VARCHAR2(250)) AS FILLER_5,
	CAST(FILLER_6 AS VARCHAR2(250)) AS FILLER_6,
	CAST(FILLER_7 AS VARCHAR2(250)) AS FILLER_7,
	CAST(FILLER_8 AS VARCHAR2(250)) AS FILLER_8,
	CAST(FILLER_9 AS VARCHAR2(250)) AS FILLER_9,
	CAST(FILLER_10 AS VARCHAR2(250)) AS FILLER_10,
	CAST(FILLER_11 AS VARCHAR2(250)) AS FILLER_11,
	CAST(FILLER_12 AS VARCHAR2(250)) AS FILLER_12,
	CAST(FILLER_13 AS VARCHAR2(250)) AS FILLER_13,
	CAST(FILLER_14 AS VARCHAR2(250)) AS FILLER_14,
	CAST(FILLER_15 AS VARCHAR2(250)) AS FILLER_15,
	CAST(FILLER_16 AS VARCHAR2(250)) AS FILLER_16,
	CAST(FILLER_17 AS VARCHAR2(250)) AS FILLER_17,
	CAST(FILLER_18 AS VARCHAR2(250)) AS FILLER_18,
	CAST(FILLER_19 AS VARCHAR2(250)) AS FILLER_19,
	CAST(FILLER_20 AS VARCHAR2(250)) AS FILLER_20,
	CAST(FILLER_21 AS VARCHAR2(250)) AS FILLER_21,
	CAST(FILLER_22 AS VARCHAR2(250)) AS FILLER_22,
	CAST(FILLER_23 AS VARCHAR2(250)) AS FILLER_23,
	CAST(FILLER_24 AS VARCHAR2(250)) AS FILLER_24,
	CAST(FILLER_25 AS VARCHAR2(250)) AS FILLER_25,
	DATA01.PROVENIENZA,
	KEYS.USERUPD,
	DATA01.DATEUPD
FROM
  (
    SELECT DISTINCT
		MONTH_END_DATE,
		REPORTING_ENTITY,
		RB_ROWID,
		USERUPD
    FROM
      RB_STG_BORROWINGS_01
  ) KEYS
  INNER JOIN
  (
    SELECT
		RB_ROWID,
		MONTH_END_DATE,
		REPORTING_ENTITY,
		INSTRUMENT,
		INTERCOMPANY,
		CALL_CODE,
		CALL_CODE_DESC,
		GL_KEY_CODE,
		GL_KEY_CODE_DESC,
		CONSOL_NODE,
		BUSINESS_UNIT,
		CURRENCY_CODE,
		FOREIGN_AMOUNT,
		CURRENCY_USQ,
		BASE_EQUIVALENT,
		MATURITY_DATE,
		REMAINING_MATURITY_DAYS,
		MATURITY_BUCKETS,
		MATURITY_BUCKETS_2,
		CUSTOMER_ID,
		"DEPO_NON-DEPO",
		FOREIGN_DOMESTIC,
		PRINCIPAL_ORIG_CCY,
		DISCOUNT_GIVEN_ORIG_CCY,
		OVERDRAFT_CASH_ORIG_CCY,
		PRINCIPAL_BASE_EQ,
		DISCOUNT_GIVEN_BASE_EQ,
		OVERDRAFT_CASH_BASE_EQ,
		PROD_TYPE_DESC,
		CUSTOMER_TYPE,
		UMD_1,
		SOURCE,
		UMD_2,
		UMD_3,
		UMD_4,
		TRADE_ID,
		REPORTABLE_Y_N,
		BU,
		ACCOUNT,
		PRODUCT,
		OPERATING_UNIT,
		DEPTID,
		CUST_CLASS,
		AFFILIATE,
		CIF_TYPE,
		CIF_TYPE_DESCRIPTION,
		DISC_GIVEN_CALL_CODE_CODEBLOCK,
		OVRDRFT_CASH_CALL_CODE_CODEBLK,
		FILLER_1,
		FILLER_2,
		FILLER_3,
		FILLER_4,
		FILLER_5,
		FILLER_6,
		FILLER_7,
		FILLER_8,
		FILLER_9,
		FILLER_10,
		FILLER_11,
		FILLER_12,
		FILLER_13,
		FILLER_14,
		FILLER_15,
		FILLER_16,
		FILLER_17,
		FILLER_18,
		FILLER_19,
		FILLER_20,
		FILLER_21,
		FILLER_22,
		FILLER_23,
		FILLER_24,
		FILLER_25,
		PROVENIENZA,
		USERUPD,
		DATEUPD
    FROM
		RB_STG_BORROWINGS_01
  ) DATA01
  ON
    KEYS.MONTH_END_DATE = DATA01.MONTH_END_DATE
    AND KEYS.REPORTING_ENTITY = DATA01.REPORTING_ENTITY
    AND KEYS.RB_ROWID = DATA01.RB_ROWID
	AND KEYS.USERUPD = DATA01.USERUPD
;