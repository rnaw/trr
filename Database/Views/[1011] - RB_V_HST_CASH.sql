--------------------------------------------------------
--  DDL for View RB_V_HST_CASH
--------------------------------------------------------

CREATE OR REPLACE NOFORCE VIEW "RB_V_HST_CASH" (
  TGK_TABLE_SEGMENT,
  RB_ROWID,
  MONTH_END_DATE,
  REPORTING_ENTITY,
  INSTRUMENT,
  SOURCE,
  INTERCOMPANY,
  CALL_CODE,
  CURRENCY_CODE,
  FOREIGN_AMOUNT,
  BASE_EQUIVALENT,
  CASH_ACCT_NBR,
  CASH_ACCOUNT_NAME,
  CUSTOMER_ID,
  CUSTOMER_NAME,
  CUSTOMER_TYPE,
  BRANCH_AGENCY_002,
  HOLDING_COM_Y9C,
  FOREIGN_DOMESTIC,
  COUNTRY_DESC,
  CONSOL_NODE,
  LEGAL_ENTITY,
  PRIMARY_GL_NBR,
  GL_KEY_CODE,
  GL_AMNT_IFRS,
  GL_AMNT_USGAAP,
  ACCRUED_INTEREST,
  HIGHLVL_PROD_CAT,
  IN_COLLECTION,
  CURR_AND_COIN,
  INTEREST_BEARING,
  FED_RESERVE,
  DEPOSIT_OR_NONDEP,
  CAPITAL_RISK_RATE,
  FOREIGN,
  DOMESTIC,
  OTHER_CASH,
  PRODUCT_TYPE,
  CUSTOMER_TYPE_PX,
  CUST_RELATION_PX,
  CUST_RELATION_GL,
  CUSTOMER_TYPE_GL,
  COUNTRY_CODE,
  CONSOL_BU_NODE,
  BUS_UNIT_NAME,
  BUSINESS_UNIT,
  ACCOUNT,
  ACCOUNT_NAME,
  PRODUCT,
  PRODUCT_NAME,
  OPERATING_UNIT,
  DEPTID,
  AFFILIATE,
  AFFILIATE_NAME,
  AFFL_CONSOL_NODE,
  CUST_CLASS,
  BU_AFFL_CHECK,
  ACCT_AFFL_CHECK,
  DESCRIPTION,
  FILLER_1,
  FILLER_2,
  FILLER_3,
  FILLER_4,
  FILLER_5,
  FILLER_6,
  FILLER_7,
  FILLER_8,
  FILLER_9,
  FILLER_10,
  FILLER_11,
  FILLER_12,
  FILLER_13,
  FILLER_14,
  FILLER_15,
  FILLER_16,
  FILLER_17,
  FILLER_18,
  FILLER_19,
  FILLER_20,
  FILLER_21,
  FILLER_22,
  FILLER_23,
  FILLER_24,
  FILLER_25,
  PROVENIENZA,
  USERUPD,
  DATEUPD
) AS 
SELECT
  CAST(TGK_TABLE_SEGMENT AS VARCHAR(2)) AS TGK_TABLE_SEGMENT,
  CAST(KEYS.RB_ROWID AS INT) AS RB_ROWID,
  TO_DATE(KEYS.MONTH_END_DATE, 'MM/DD/YYYY') AS MONTH_END_DATE,
  CAST(KEYS.REPORTING_ENTITY AS VARCHAR2(6)) AS REPORTING_ENTITY,
  CAST(DATA.INSTRUMENT AS VARCHAR2(27)) AS INSTRUMENT,
  CAST(DATA.SOURCE AS VARCHAR2(4)) AS SOURCE,
  CAST(DATA.INTERCOMPANY AS VARCHAR2(15)) AS INTERCOMPANY,
  CAST(DATA.CALL_CODE AS VARCHAR2(15)) AS CALL_CODE,
  CAST(DATA.CURRENCY_CODE AS VARCHAR2(3)) AS CURRENCY_CODE,
  CAST(DATA.FOREIGN_AMOUNT AS NUMBER(23,3)) AS FOREIGN_AMOUNT,
  CAST(DATA.BASE_EQUIVALENT AS NUMBER(23,3)) AS BASE_EQUIVALENT,
  CAST(DATA.CASH_ACCT_NBR AS VARCHAR2(20)) AS CASH_ACCT_NBR,
  CAST(DATA.CASH_ACCOUNT_NAME AS VARCHAR2(35)) AS CASH_ACCOUNT_NAME,
  CAST(DATA.CUSTOMER_ID AS VARCHAR2(10)) AS CUSTOMER_ID,
  CAST(DATA.CUSTOMER_NAME AS VARCHAR2(50)) AS CUSTOMER_NAME,
  CAST(DATA.CUSTOMER_TYPE AS VARCHAR2(30)) AS CUSTOMER_TYPE,
  CAST(DATA.BRANCH_AGENCY_002 AS VARCHAR2(1)) AS BRANCH_AGENCY_002,
  CAST(DATA.HOLDING_COM_Y9C AS VARCHAR2(1)) AS HOLDING_COM_Y9C,
  CAST(DATA.FOREIGN_DOMESTIC AS VARCHAR2(8)) AS FOREIGN_DOMESTIC,
  CAST(DATA.COUNTRY_DESC AS VARCHAR2(30)) AS COUNTRY_DESC,
  CAST(DATA.CONSOL_NODE AS VARCHAR2(20)) AS CONSOL_NODE,
  CAST(DATA.LEGAL_ENTITY AS VARCHAR2(12)) AS LEGAL_ENTITY,
  CAST(DATA.PRIMARY_GL_NBR AS VARCHAR2(10)) AS PRIMARY_GL_NBR,
  CAST(DATA.GL_KEY_CODE AS VARCHAR2(15)) AS GL_KEY_CODE,
  CAST(DATA.GL_AMNT_IFRS AS VARCHAR2(20)) AS GL_AMNT_IFRS,
  CAST(DATA.GL_AMNT_USGAAP AS VARCHAR2(20)) AS GL_AMNT_USGAAP,
  CAST(DATA.ACCRUED_INTEREST AS NUMBER(23,3)) AS ACCRUED_INTEREST,
  CAST(DATA.HIGHLVL_PROD_CAT AS VARCHAR2(10)) AS HIGHLVL_PROD_CAT,
  CAST(DATA.IN_COLLECTION AS VARCHAR2(1)) AS IN_COLLECTION,
  CAST(DATA.CURR_AND_COIN AS VARCHAR2(1)) AS CURR_AND_COIN,
  CAST(DATA.INTEREST_BEARING AS VARCHAR2(20)) AS INTEREST_BEARING,
  CAST(DATA.FED_RESERVE AS VARCHAR2(1)) AS FED_RESERVE,
  CAST(DATA.DEPOSIT_OR_NONDEP AS VARCHAR2(20)) AS DEPOSIT_OR_NONDEP,
  CAST(DATA.CAPITAL_RISK_RATE AS NUMBER(6,6)) AS CAPITAL_RISK_RATE,
  CAST(DATA.FOREIGN AS VARCHAR2(1)) AS FOREIGN,
  CAST(DATA.DOMESTIC AS VARCHAR2(1)) AS DOMESTIC,
  CAST(DATA.OTHER_CASH AS VARCHAR2(10)) AS OTHER_CASH,
  CAST(DATA.PRODUCT_TYPE AS VARCHAR2(25)) AS PRODUCT_TYPE,
  CAST(DATA.CUSTOMER_TYPE_PX AS VARCHAR2(4)) AS CUSTOMER_TYPE_PX,
  CAST(DATA.CUST_RELATION_PX AS VARCHAR2(2)) AS CUST_RELATION_PX,
  CAST(DATA.CUST_RELATION_GL AS VARCHAR2(1)) AS CUST_RELATION_GL,
  CAST(DATA.CUSTOMER_TYPE_GL AS VARCHAR2(4)) AS CUSTOMER_TYPE_GL,
  CAST(DATA.COUNTRY_CODE AS VARCHAR2(5)) AS COUNTRY_CODE,
  CAST(DATA.CONSOL_BU_NODE AS VARCHAR2(20)) AS CONSOL_BU_NODE,
  CAST(DATA.BUS_UNIT_NAME AS VARCHAR2(30)) AS BUS_UNIT_NAME,
  CAST(DATA.BUSINESS_UNIT AS VARCHAR2(5)) AS BUSINESS_UNIT,
  CAST(DATA.ACCOUNT AS VARCHAR2(10)) AS ACCOUNT,
  CAST(DATA.ACCOUNT_NAME AS VARCHAR2(50)) AS ACCOUNT_NAME,
  CAST(DATA.PRODUCT AS VARCHAR2(6)) AS PRODUCT,
  CAST(DATA.PRODUCT_NAME AS VARCHAR2(30)) AS PRODUCT_NAME,
  CAST(DATA.OPERATING_UNIT AS VARCHAR2(8)) AS OPERATING_UNIT,
  CAST(DATA.DEPTID AS VARCHAR2(15)) AS DEPTID,
  CAST(DATA.AFFILIATE AS VARCHAR2(5)) AS AFFILIATE,
  CAST(DATA.AFFILIATE_NAME AS VARCHAR2(30)) AS AFFILIATE_NAME,
  CAST(DATA.AFFL_CONSOL_NODE AS VARCHAR2(30)) AS AFFL_CONSOL_NODE,
  CAST(DATA.CUST_CLASS AS VARCHAR2(10)) AS CUST_CLASS,
  CAST(DATA.BU_AFFL_CHECK AS VARCHAR2(20)) AS BU_AFFL_CHECK,
  CAST(DATA.ACCT_AFFL_CHECK AS VARCHAR2(20)) AS ACCT_AFFL_CHECK,
  CAST(DATA.DESCRIPTION AS VARCHAR2(100)) AS DESCRIPTION,
  CAST(DATA.FILLER_1 AS VARCHAR2(250)) AS FILLER_1,
  CAST(DATA.FILLER_2 AS VARCHAR2(250)) AS FILLER_2,
  CAST(DATA.FILLER_3 AS VARCHAR2(250)) AS FILLER_3,
  CAST(DATA.FILLER_4 AS VARCHAR2(250)) AS FILLER_4,
  CAST(DATA.FILLER_5 AS VARCHAR2(250)) AS FILLER_5,
  CAST(DATA.FILLER_6 AS VARCHAR2(250)) AS FILLER_6,
  CAST(DATA.FILLER_7 AS VARCHAR2(250)) AS FILLER_7,
  CAST(DATA.FILLER_8 AS VARCHAR2(250)) AS FILLER_8,
  CAST(DATA.FILLER_9 AS VARCHAR2(250)) AS FILLER_9,
  CAST(DATA.FILLER_10 AS VARCHAR2(250)) AS FILLER_10,
  CAST(DATA.FILLER_11 AS VARCHAR2(250)) AS FILLER_11,
  CAST(DATA.FILLER_12 AS VARCHAR2(250)) AS FILLER_12,
  CAST(DATA.FILLER_13 AS VARCHAR2(250)) AS FILLER_13,
  CAST(DATA.FILLER_14 AS VARCHAR2(250)) AS FILLER_14,
  CAST(DATA.FILLER_15 AS VARCHAR2(250)) AS FILLER_15,
  CAST(DATA.FILLER_16 AS VARCHAR2(250)) AS FILLER_16,
  CAST(DATA.FILLER_17 AS VARCHAR2(250)) AS FILLER_17,
  CAST(DATA.FILLER_18 AS VARCHAR2(250)) AS FILLER_18,
  CAST(DATA.FILLER_19 AS VARCHAR2(250)) AS FILLER_19,
  CAST(DATA.FILLER_20 AS VARCHAR2(250)) AS FILLER_20,
  CAST(DATA.FILLER_21 AS VARCHAR2(250)) AS FILLER_21,
  CAST(DATA.FILLER_22 AS VARCHAR2(250)) AS FILLER_22,
  CAST(DATA.FILLER_23 AS VARCHAR2(250)) AS FILLER_23,
  CAST(DATA.FILLER_24 AS VARCHAR2(250)) AS FILLER_24,
  CAST(DATA.FILLER_25 AS VARCHAR2(250)) AS FILLER_25,
  DATA.PROVENIENZA,
  DATA.USERUPD,
  DATA.DATEUPD
FROM
  (
    SELECT DISTINCT
      MONTH_END_DATE,
      REPORTING_ENTITY,
      RB_ROWID
    FROM
      RB_STG_CASH_01
  ) KEYS
  INNER JOIN
  (
    SELECT
        CAST('01' AS VARCHAR(2)) AS TGK_TABLE_SEGMENT,
        MONTH_END_DATE,
        REPORTING_ENTITY,
        RB_ROWID,
        INSTRUMENT,
        SOURCE,
        INTERCOMPANY,
        CALL_CODE,
        CURRENCY_CODE,
        FOREIGN_AMOUNT,
        BASE_EQUIVALENT,
        CASH_ACCT_NBR,
        CASH_ACCOUNT_NAME,
        CUSTOMER_ID,
        CUSTOMER_NAME,
        CUSTOMER_TYPE,
        BRANCH_AGENCY_002,
        HOLDING_COM_Y9C,
        FOREIGN_DOMESTIC,
        COUNTRY_DESC,
        CONSOL_NODE,
        LEGAL_ENTITY,
        PRIMARY_GL_NBR,
        GL_KEY_CODE,
        GL_AMNT_IFRS,
        GL_AMNT_USGAAP,
        ACCRUED_INTEREST,
        HIGHLVL_PROD_CAT,
        IN_COLLECTION,
        CURR_AND_COIN,
        INTEREST_BEARING,
        FED_RESERVE,
        DEPOSIT_OR_NONDEP,
        CAPITAL_RISK_RATE,
        FOREIGN,
        DOMESTIC,
        OTHER_CASH,
        PRODUCT_TYPE,
        CUSTOMER_TYPE_PX,
        CUST_RELATION_PX,
        CUST_RELATION_GL,
        CUSTOMER_TYPE_GL,
        COUNTRY_CODE,
        CONSOL_BU_NODE,
        BUS_UNIT_NAME,
        BUSINESS_UNIT,
        ACCOUNT,
        ACCOUNT_NAME,
        PRODUCT,
        PRODUCT_NAME,
        OPERATING_UNIT,
        DEPTID,
        AFFILIATE,
        AFFILIATE_NAME,
        AFFL_CONSOL_NODE,
        CUST_CLASS,
        BU_AFFL_CHECK,
        ACCT_AFFL_CHECK,
        DESCRIPTION,
        FILLER_1,
        FILLER_2,
        FILLER_3,
        FILLER_4,
        FILLER_5,
        FILLER_6,
        FILLER_7,
        FILLER_8,
        FILLER_9,
        FILLER_10,
        FILLER_11,
        FILLER_12,
        FILLER_13,
        FILLER_14,
        FILLER_15,
        FILLER_16,
        FILLER_17,
        FILLER_18,
        FILLER_19,
        FILLER_20,
        FILLER_21,
        FILLER_22,
        FILLER_23,
        FILLER_24,
        FILLER_25,
        PROVENIENZA,
        USERUPD,
        DATEUPD
    FROM
      RB_STG_CASH_01
  ) DATA
  ON
    KEYS.MONTH_END_DATE = DATA.MONTH_END_DATE
    AND KEYS.REPORTING_ENTITY = DATA.REPORTING_ENTITY
    AND KEYS.RB_ROWID = DATA.RB_ROWID
;