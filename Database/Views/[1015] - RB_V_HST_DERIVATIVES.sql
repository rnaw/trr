--------------------------------------------------------
--  DDL for View RB_V_HST_DERIVATIVES
--------------------------------------------------------

CREATE OR REPLACE NOFORCE VIEW "RB_V_HST_DERIVATIVES" (
	RB_ROWID,
	MONTH_END_DATE,
	REPORTING_ENTITY,
	INSTRUMENT,
	INTERCOMPANY,
	CONSOL_NODE,
	BUSINESS_UNIT,
	GL_KEY_CODE,
	GL_KEY_CODE_DESC,
	CALL_CODE,
	CALL_CODE_DESC,
	ACCRUAL_VALUE,
	CLEAN_PRICE_VALUE,
	DIRTY_PRICE_VALUE,
	MANUAL_ADJUSTMENTS,
	CREDIT_ADJ,
	CREDIT_VALUATION_ADJUSTMENT,
	USQ_NOTIONAL,
	POSITIVE_NEGATIVE,
	BUY_SELL_INDICATOR,
	MATURITY_PCT_WEIGHT,
	ADD_ON,
	REPLACEMENT_VALUE,
	CREDIT_EQUIVALENT,
	CPTY_WGHT,
	AMT_BOUGHT,
	AMT_SOLD,
	CCY_RECEIVE,
	CCY_PAY,
	SOURCE,
	ACC_INT_REC_GL_US_GAAP_BASE_EQ,
	UNSET_TRADE_GL_US_GAAP_BASE_EQ,
	RECEIVABLES_ADVANCES_BASE_EQ,
	UNRLZED_PLG_GL_US_GAAP_BASE_EQ,
	UNREAL_PLG_CCY_SWAP_US_BASE_EQ,
	ACC_INT_PAY_GL_US_GAAP_BASE_EQ,
	ACC_FEE_PAY_GL_US_GAAP_BASE_EQ,
	UNSET_TRADE_PAYABLE_US_BASE_EQ,
	UNRLZED_PLL_GL_US_GAAP_BASE_EQ,
	UNREAL_PLL_CCY_SWAP_US_BASE_EQ,
	MARCA_PROVISION,
	NOTL_OPT_BUY_US_GAAP_BASE_EQ,
	NOTL_SWAP_BUY_US_GAAP_BASE_EQ,
	NOTL_OPT_GL_US_GAAP_BASE_EQ,
	NOTL_OPT_SOLD_US_GAAP_BASE_EQ,
	NOTL_SWAP_SOLD_US_GAAP_BASE_EQ,
	IBF_ONLY_RAL_COLUMN_B_YN,
	REGULATORY_RISK_RATINGS,
	LEVEL_FAIR_VALUE,
	CRC_RATING,
	UMD1,
	UMD2,
	UMD3,
	MATURITY_DATE,
	REMAINING_MATURITY,
	MATURITY_BUCKETS,
	ONE_YEAR_OR_LESS,
	ONE_TO_FIVE_YEARS,
	GREATER_THAN_FIVE_YEARS,
	ACCOUNTING_CLASSIFICATION,
	BA_CODE,
	ENTITY_ENT_CODE,
	COUNTERPARTY_ENT_CODE,
	COVERED_MARKET_RISK_RULE,
	AFFIRMED_REG_RPT_CAP_GUARANTEE,
	SECURITY_DESCRIPTION,
	INVESTMENT_GRADE,
	SUBINVESTMENT_GRADE,
	UMD4,
	UMD5,
	UMD6,
	TRADE_ID,
	CUSTOMER_ID,
	RELATED_DEP_INST,
	CUSTOMER_NAME,
	CUSTOMER_TYPE,
	CITY,
	OPERATING_STATE,
	FOREIGN_DOMESTIC,
	COUNTRY_CODE,
	COUNTRY_DESC,
	RELATION_ID,
	FX_RATE_REC,
	FX_RATE_PAY,
	STRIKE_PRICE,
	FIXED_OR_VARIABLE,
	RECEIVE_INTEREST_RATE,
	PAY_INTEREST_RATE,
	INDEX_RATE_ADD,
	FLOAT_FREQ,
	LAST_RATE_RESET_DATE,
	NEXT_RATE_RESET_DATE,
	BRANCH_SUBSIDIARY,
	START_DATE,
	TRADE_DATE,
	SETTLE_DATE,
	UMD7,
	UMD8,
	UMD9,
	UMD10,
	ACCOUNT,
	PRODUCT,
	OPERATING_UNIT,
	AFFILIATE,
	CUST_CLASS,
	CODEBLOCK,
	ACCRUAL_CODEBLOCK,
	UNREALIZED_CODEBLOCK,
	CALL_CODE_CONCAT,
	FILLER_1,
	FILLER_2,
	FILLER_3,
	FILLER_4,
	FILLER_5,
	FILLER_6,
	FILLER_7,
	FILLER_8,
	FILLER_9,
	FILLER_10,
	FILLER_11,
	FILLER_12,
	FILLER_13,
	FILLER_14,
	FILLER_15,
	FILLER_16,
	FILLER_17,
	FILLER_18,
	FILLER_19,
	FILLER_20,
	FILLER_21,
	FILLER_22,
	FILLER_23,
	FILLER_24,
	FILLER_25,
	PROVENIENZA,
	USERUPD,
	DATEUPD
) AS 
SELECT
	CAST(KEYS.RB_ROWID AS NUMBER) AS RB_ROWID,
	TO_DATE(KEYS.MONTH_END_DATE, 'MMDDYYYY') AS MONTH_END_DATE,
	CAST(KEYS.REPORTING_ENTITY AS VARCHAR2(6)) AS REPORTING_ENTITY,
	CAST(DATA01.INSTRUMENT AS VARCHAR2(27)) AS INSTRUMENT,
	CAST(DATA01.INTERCOMPANY AS VARCHAR2(15)) AS INTERCOMPANY,
	CAST(DATA01.CONSOL_NODE AS VARCHAR2(20)) AS CONSOL_NODE,
	CAST(DATA01.BUSINESS_UNIT AS VARCHAR2(5)) AS BUSINESS_UNIT,
	CAST(DATA01.GL_KEY_CODE AS VARCHAR2(15)) AS GL_KEY_CODE,
	CAST(DATA01.GL_KEY_CODE_DESC AS VARCHAR2(150)) AS GL_KEY_CODE_DESC,
	CAST(DATA01.CALL_CODE AS VARCHAR2(15)) AS CALL_CODE,
	CAST(DATA01.CALL_CODE_DESC AS VARCHAR2(150)) AS CALL_CODE_DESC,
	CAST(DATA01.ACCRUAL_VALUE AS NUMBER(23,3)) AS ACCRUAL_VALUE,
	CAST(DATA01.CLEAN_PRICE_VALUE AS NUMBER(23,3)) AS CLEAN_PRICE_VALUE,
	CAST(DATA01.DIRTY_PRICE_VALUE AS NUMBER(23,3)) AS DIRTY_PRICE_VALUE,
	CAST(DATA02.MANUAL_ADJUSTMENTS AS NUMBER(23,3)) AS MANUAL_ADJUSTMENTS,
	CAST(DATA01.CREDIT_ADJ AS NUMBER(23,3)) AS CREDIT_ADJ,
	CAST(DATA01.CREDIT_VALUATION_ADJUSTMENT AS NUMBER(23,3)) AS CREDIT_VALUATION_ADJUSTMENT,
	CAST(DATA01.USQ_NOTIONAL AS NUMBER(23,3)) AS USQ_NOTIONAL,
	CAST(DATA01.POSITIVE_NEGATIVE AS VARCHAR2(8)) AS POSITIVE_NEGATIVE,
	CAST(DATA01.BUY_SELL_INDICATOR AS VARCHAR2(4)) AS BUY_SELL_INDICATOR,
	CAST(DATA01.MATURITY_PCT_WEIGHT AS NUMBER(4,3)) AS MATURITY_PCT_WEIGHT,
	CAST(DATA01.ADD_ON AS NUMBER(23,3)) AS ADD_ON,
	CAST(DATA01.REPLACEMENT_VALUE AS NUMBER(23,3)) AS REPLACEMENT_VALUE,
	CAST(DATA01.CREDIT_EQUIVALENT AS NUMBER(23,3)) AS CREDIT_EQUIVALENT,
	CAST(DATA01.CPTY_WGHT AS NUMBER(4,3)) AS CPTY_WGHT,
	CAST(DATA01.AMT_BOUGHT AS NUMBER(23,3)) AS AMT_BOUGHT,
	CAST(DATA01.AMT_SOLD AS NUMBER(23,3)) AS AMT_SOLD,
	CAST(DATA01.CCY_RECEIVE AS VARCHAR2(3)) AS CCY_RECEIVE,
	CAST(DATA01.CCY_PAY AS VARCHAR2(3)) AS CCY_PAY,
	CAST(DATA01.SOURCE AS VARCHAR2(4)) AS SOURCE,
	CAST(DATA01.ACC_INT_REC_GL_US_GAAP_BASE_EQ AS NUMBER(23,3)) AS ACC_INT_REC_GL_US_GAAP_BASE_EQ,
	CAST(DATA01.UNSET_TRADE_GL_US_GAAP_BASE_EQ AS NUMBER(23,3)) AS UNSET_TRADE_GL_US_GAAP_BASE_EQ,
	CAST(DATA01.RECEIVABLES_ADVANCES_BASE_EQ AS NUMBER(23,3)) AS RECEIVABLES_ADVANCES_BASE_EQ,
	CAST(DATA01.UNRLZED_PLG_GL_US_GAAP_BASE_EQ AS NUMBER(23,3)) AS UNRLZED_PLG_GL_US_GAAP_BASE_EQ,
	CAST(DATA01.UNREAL_PLG_CCY_SWAP_US_BASE_EQ AS NUMBER(23,3)) AS UNREAL_PLG_CCY_SWAP_US_BASE_EQ,
	CAST(DATA01.ACC_INT_PAY_GL_US_GAAP_BASE_EQ AS NUMBER(23,3)) AS ACC_INT_PAY_GL_US_GAAP_BASE_EQ,
	CAST(DATA01.ACC_FEE_PAY_GL_US_GAAP_BASE_EQ AS NUMBER(23,3)) AS ACC_FEE_PAY_GL_US_GAAP_BASE_EQ,
	CAST(DATA01.UNSET_TRADE_PAYABLE_US_BASE_EQ AS NUMBER(23,3)) AS UNSET_TRADE_PAYABLE_US_BASE_EQ,
	CAST(DATA01.UNRLZED_PLL_GL_US_GAAP_BASE_EQ AS NUMBER(23,3)) AS UNRLZED_PLL_GL_US_GAAP_BASE_EQ,
	CAST(DATA01.UNREAL_PLL_CCY_SWAP_US_BASE_EQ AS NUMBER(23,3)) AS UNREAL_PLL_CCY_SWAP_US_BASE_EQ,
	CAST(DATA01.MARCA_PROVISION AS NUMBER(23,3)) AS MARCA_PROVISION,
	CAST(DATA01.NOTL_OPT_BUY_US_GAAP_BASE_EQ AS NUMBER(23,3)) AS NOTL_OPT_BUY_US_GAAP_BASE_EQ,
	CAST(DATA01.NOTL_SWAP_BUY_US_GAAP_BASE_EQ AS NUMBER(23,3)) AS NOTL_SWAP_BUY_US_GAAP_BASE_EQ,
	CAST(DATA01.NOTL_OPT_GL_US_GAAP_BASE_EQ AS NUMBER(23,3)) AS NOTL_OPT_GL_US_GAAP_BASE_EQ,
	CAST(DATA01.NOTL_OPT_SOLD_US_GAAP_BASE_EQ AS NUMBER(23,3)) AS NOTL_OPT_SOLD_US_GAAP_BASE_EQ,
	CAST(DATA01.NOTL_SWAP_SOLD_US_GAAP_BASE_EQ AS NUMBER(23,3)) AS NOTL_SWAP_SOLD_US_GAAP_BASE_EQ,
	CAST(DATA01.IBF_ONLY_RAL_COLUMN_B_YN AS VARCHAR2(5)) AS IBF_ONLY_RAL_COLUMN_B_YN,
	CAST(DATA01.REGULATORY_RISK_RATINGS AS NUMBER(4,3)) AS REGULATORY_RISK_RATINGS,
	CAST(DATA01.LEVEL_FAIR_VALUE AS VARCHAR2(10)) AS LEVEL_FAIR_VALUE,
	CAST(DATA01.CRC_RATING AS NUMBER(4,3)) AS CRC_RATING,
	CAST(DATA01.UMD1 AS VARCHAR2(250)) AS UMD1,
	CAST(DATA01.UMD2 AS VARCHAR2(250)) AS UMD2,
	CAST(DATA01.UMD3 AS VARCHAR2(250)) AS UMD3,
	CAST(DATA01.MATURITY_DATE AS VARCHAR2(250)) AS MATURITY_DATE,
	CAST(DATA01.REMAINING_MATURITY AS VARCHAR2(6)) AS REMAINING_MATURITY,
	CAST(DATA01.MATURITY_BUCKETS AS VARCHAR2(50)) AS MATURITY_BUCKETS,
	CAST(DATA01.ONE_YEAR_OR_LESS AS NUMBER(23,3)) AS ONE_YEAR_OR_LESS,
	CAST(DATA01.ONE_TO_FIVE_YEARS AS NUMBER(23,3)) AS ONE_TO_FIVE_YEARS,
	CAST(DATA01.GREATER_THAN_FIVE_YEARS AS NUMBER(23,3)) AS GREATER_THAN_FIVE_YEARS,
	CAST(DATA01.ACCOUNTING_CLASSIFICATION AS VARCHAR2(6)) AS ACCOUNTING_CLASSIFICATION,
	CAST(DATA01.BA_CODE AS VARCHAR2(30)) AS BA_CODE,
	CAST(DATA01.ENTITY_ENT_CODE AS VARCHAR2(6)) AS ENTITY_ENT_CODE,
	CAST(DATA01.COUNTERPARTY_ENT_CODE AS VARCHAR2(6)) AS COUNTERPARTY_ENT_CODE,
	CAST(DATA01.COVERED_MARKET_RISK_RULE AS VARCHAR2(150)) AS COVERED_MARKET_RISK_RULE,
	CAST(DATA01.AFFIRMED_REG_RPT_CAP_GUARANTEE AS VARCHAR2(150)) AS AFFIRMED_REG_RPT_CAP_GUARANTEE,
	CAST(DATA01.SECURITY_DESCRIPTION AS VARCHAR2(150)) AS SECURITY_DESCRIPTION,
	CAST(DATA01.INVESTMENT_GRADE AS VARCHAR2(250)) AS INVESTMENT_GRADE,
	CAST(DATA01.SUBINVESTMENT_GRADE AS VARCHAR2(250)) AS SUBINVESTMENT_GRADE,
	CAST(DATA01.UMD4 AS VARCHAR2(250)) AS UMD4,
	CAST(DATA01.UMD5 AS VARCHAR2(250)) AS UMD5,
	CAST(DATA01.UMD6 AS VARCHAR2(250)) AS UMD6,
	CAST(DATA01.TRADE_ID AS VARCHAR2(20)) AS TRADE_ID,
	CAST(DATA01.CUSTOMER_ID AS VARCHAR2(10)) AS CUSTOMER_ID,
	CAST(DATA01.RELATED_DEP_INST AS VARCHAR2(20)) AS RELATED_DEP_INST,
	CAST(DATA01.CUSTOMER_NAME AS VARCHAR2(50)) AS CUSTOMER_NAME,
	CAST(DATA01.CUSTOMER_TYPE AS VARCHAR2(30)) AS CUSTOMER_TYPE,
	CAST(DATA01.CITY AS VARCHAR2(30)) AS CITY,
	CAST(DATA01.OPERATING_STATE AS VARCHAR2(10)) AS OPERATING_STATE,
	CAST(DATA01.FOREIGN_DOMESTIC AS VARCHAR2(8)) AS FOREIGN_DOMESTIC,
	CAST(DATA01.COUNTRY_CODE AS VARCHAR2(5)) AS COUNTRY_CODE,
	CAST(DATA01.COUNTRY_DESC AS VARCHAR2(30)) AS COUNTRY_DESC,
	CAST(DATA01.RELATION_ID AS VARCHAR2(10)) AS RELATION_ID,
	CAST(DATA01.FX_RATE_REC AS NUMBER(15,8)) AS FX_RATE_REC,
	CAST(DATA01.FX_RATE_PAY AS NUMBER(15,8)) AS FX_RATE_PAY,
	CAST(DATA01.STRIKE_PRICE AS NUMBER(15,8)) AS STRIKE_PRICE,
	CAST(DATA01.FIXED_OR_VARIABLE AS VARCHAR2(20)) AS FIXED_OR_VARIABLE,
	CAST(DATA01.RECEIVE_INTEREST_RATE AS NUMBER(15,8)) AS RECEIVE_INTEREST_RATE,
	CAST(DATA01.PAY_INTEREST_RATE AS NUMBER(15,8)) AS PAY_INTEREST_RATE,
	CAST(DATA01.INDEX_RATE_ADD AS NUMBER(8,4)) AS INDEX_RATE_ADD,
	CAST(DATA01.FLOAT_FREQ AS VARCHAR2(12)) AS FLOAT_FREQ,
	TO_DATE(DATA01.LAST_RATE_RESET_DATE, 'MMDDYYYY') AS LAST_RATE_RESET_DATE,
	TO_DATE(DATA01.NEXT_RATE_RESET_DATE, 'MMDDYYYY') AS NEXT_RATE_RESET_DATE,
	CAST(DATA01.BRANCH_SUBSIDIARY AS VARCHAR2(12)) AS BRANCH_SUBSIDIARY,
	TO_DATE(DATA01.START_DATE, 'MMDDYYYY') AS START_DATE,
	TO_DATE(DATA01.TRADE_DATE, 'MMDDYYYY') AS TRADE_DATE,
	TO_DATE(DATA01.SETTLE_DATE, 'MMDDYYYY') AS SETTLE_DATE,
	CAST(DATA01.UMD7 AS VARCHAR2(250)) AS UMD7,
	CAST(DATA01.UMD8 AS VARCHAR2(250)) AS UMD8,
	CAST(DATA01.UMD9 AS VARCHAR2(250)) AS UMD9,
	CAST(DATA01.UMD10 AS VARCHAR2(250)) AS UMD10,
	CAST(DATA01.ACCOUNT AS VARCHAR2(10)) AS ACCOUNT,
	CAST(DATA01.PRODUCT AS VARCHAR2(6)) AS PRODUCT,
	CAST(DATA01.OPERATING_UNIT AS VARCHAR2(8)) AS OPERATING_UNIT,
	CAST(DATA01.AFFILIATE AS VARCHAR2(5)) AS AFFILIATE,
	CAST(DATA01.CUST_CLASS AS VARCHAR2(10)) AS CUST_CLASS,
	CAST(DATA01.CODEBLOCK AS VARCHAR2(250)) AS CODEBLOCK,
	CAST(DATA01.ACCRUAL_CODEBLOCK AS VARCHAR2(250)) AS ACCRUAL_CODEBLOCK,
	CAST(DATA01.UNREALIZED_CODEBLOCK AS VARCHAR2(250)) AS UNREALIZED_CODEBLOCK,
	CAST(DATA01.CALL_CODE_CONCAT AS VARCHAR2(250)) AS CALL_CODE_CONCAT,
	CAST(DATA01.FILLER_1 AS VARCHAR2(250)) AS FILLER_1,
	CAST(DATA01.FILLER_2 AS VARCHAR2(250)) AS FILLER_2,
	CAST(DATA01.FILLER_3 AS VARCHAR2(250)) AS FILLER_3,
	CAST(DATA01.FILLER_4 AS VARCHAR2(250)) AS FILLER_4,
	CAST(DATA01.FILLER_5 AS VARCHAR2(250)) AS FILLER_5,
	CAST(DATA01.FILLER_6 AS VARCHAR2(250)) AS FILLER_6,
	CAST(DATA01.FILLER_7 AS VARCHAR2(250)) AS FILLER_7,
	CAST(DATA01.FILLER_8 AS VARCHAR2(250)) AS FILLER_8,
	CAST(DATA01.FILLER_9 AS VARCHAR2(250)) AS FILLER_9,
	CAST(DATA01.FILLER_10 AS VARCHAR2(250)) AS FILLER_10,
	CAST(DATA01.FILLER_11 AS VARCHAR2(250)) AS FILLER_11,
	CAST(DATA01.FILLER_12 AS VARCHAR2(250)) AS FILLER_12,
	CAST(DATA01.FILLER_13 AS VARCHAR2(250)) AS FILLER_13,
	CAST(DATA01.FILLER_14 AS VARCHAR2(250)) AS FILLER_14,
	CAST(DATA01.FILLER_15 AS VARCHAR2(250)) AS FILLER_15,
	CAST(DATA01.FILLER_16 AS VARCHAR2(250)) AS FILLER_16,
	CAST(DATA01.FILLER_17 AS VARCHAR2(250)) AS FILLER_17,
	CAST(DATA01.FILLER_18 AS VARCHAR2(250)) AS FILLER_18,
	CAST(DATA01.FILLER_19 AS VARCHAR2(250)) AS FILLER_19,
	CAST(DATA02.FILLER_20 AS VARCHAR2(250)) AS FILLER_20,
	CAST(DATA02.FILLER_21 AS VARCHAR2(250)) AS FILLER_21,
	CAST(DATA02.FILLER_22 AS VARCHAR2(250)) AS FILLER_22,
	CAST(DATA02.FILLER_23 AS VARCHAR2(250)) AS FILLER_23,
	CAST(DATA02.FILLER_24 AS VARCHAR2(250)) AS FILLER_24,
	CAST(DATA02.FILLER_25 AS VARCHAR2(250)) AS FILLER_25,
	DATA01.PROVENIENZA,
	KEYS.USERUPD,
	DATA01.DATEUPD
FROM
  (
    SELECT DISTINCT
		MONTH_END_DATE,
		REPORTING_ENTITY,
		RB_ROWID,
		USERUPD
    FROM
      RB_STG_DERIVATIVES_01
  ) KEYS
  INNER JOIN
  (
    SELECT
		RB_ROWID,
		MONTH_END_DATE,
		REPORTING_ENTITY,
		INSTRUMENT,
		INTERCOMPANY,
		CONSOL_NODE,
		BUSINESS_UNIT,
		GL_KEY_CODE,
		GL_KEY_CODE_DESC,
		CALL_CODE,
		CALL_CODE_DESC,
		ACCRUAL_VALUE,
		CLEAN_PRICE_VALUE,
		DIRTY_PRICE_VALUE,
		CREDIT_ADJ,
		CREDIT_VALUATION_ADJUSTMENT,
		USQ_NOTIONAL,
		POSITIVE_NEGATIVE,
		BUY_SELL_INDICATOR,
		MATURITY_PCT_WEIGHT,
		ADD_ON,
		REPLACEMENT_VALUE,
		CREDIT_EQUIVALENT,
		CPTY_WGHT,
		AMT_BOUGHT,
		AMT_SOLD,
		CCY_RECEIVE,
		CCY_PAY,
		SOURCE,
		ACC_INT_REC_GL_US_GAAP_BASE_EQ,
		UNSET_TRADE_GL_US_GAAP_BASE_EQ,
		RECEIVABLES_ADVANCES_BASE_EQ,
		UNRLZED_PLG_GL_US_GAAP_BASE_EQ,
		UNREAL_PLG_CCY_SWAP_US_BASE_EQ,
		ACC_INT_PAY_GL_US_GAAP_BASE_EQ,
		ACC_FEE_PAY_GL_US_GAAP_BASE_EQ,
		UNSET_TRADE_PAYABLE_US_BASE_EQ,
		UNRLZED_PLL_GL_US_GAAP_BASE_EQ,
		UNREAL_PLL_CCY_SWAP_US_BASE_EQ,
		MARCA_PROVISION,
		NOTL_OPT_BUY_US_GAAP_BASE_EQ,
		NOTL_SWAP_BUY_US_GAAP_BASE_EQ,
		NOTL_OPT_GL_US_GAAP_BASE_EQ,
		NOTL_OPT_SOLD_US_GAAP_BASE_EQ,
		NOTL_SWAP_SOLD_US_GAAP_BASE_EQ,
		IBF_ONLY_RAL_COLUMN_B_YN,
		REGULATORY_RISK_RATINGS,
		LEVEL_FAIR_VALUE,
		CRC_RATING,
		UMD1,
		UMD2,
		UMD3,
		MATURITY_DATE,
		REMAINING_MATURITY,
		MATURITY_BUCKETS,
		ONE_YEAR_OR_LESS,
		ONE_TO_FIVE_YEARS,
		GREATER_THAN_FIVE_YEARS,
		ACCOUNTING_CLASSIFICATION,
		BA_CODE,
		ENTITY_ENT_CODE,
		COUNTERPARTY_ENT_CODE,
		COVERED_MARKET_RISK_RULE,
		AFFIRMED_REG_RPT_CAP_GUARANTEE,
		SECURITY_DESCRIPTION,
		INVESTMENT_GRADE,
		SUBINVESTMENT_GRADE,
		UMD4,
		UMD5,
		UMD6,
		TRADE_ID,
		CUSTOMER_ID,
		RELATED_DEP_INST,
		CUSTOMER_NAME,
		CUSTOMER_TYPE,
		CITY,
		OPERATING_STATE,
		FOREIGN_DOMESTIC,
		COUNTRY_CODE,
		COUNTRY_DESC,
		RELATION_ID,
		FX_RATE_REC,
		FX_RATE_PAY,
		STRIKE_PRICE,
		FIXED_OR_VARIABLE,
		RECEIVE_INTEREST_RATE,
		PAY_INTEREST_RATE,
		INDEX_RATE_ADD,
		FLOAT_FREQ,
		LAST_RATE_RESET_DATE,
		NEXT_RATE_RESET_DATE,
		BRANCH_SUBSIDIARY,
		START_DATE,
		TRADE_DATE,
		SETTLE_DATE,
		UMD7,
		UMD8,
		UMD9,
		UMD10,
		ACCOUNT,
		PRODUCT,
		OPERATING_UNIT,
		AFFILIATE,
		CUST_CLASS,
		CODEBLOCK,
		ACCRUAL_CODEBLOCK,
		UNREALIZED_CODEBLOCK,
		CALL_CODE_CONCAT,
		FILLER_1,
		FILLER_2,
		FILLER_3,
		FILLER_4,
		FILLER_5,
		FILLER_6,
		FILLER_7,
		FILLER_8,
		FILLER_9,
		FILLER_10,
		FILLER_11,
		FILLER_12,
		FILLER_13,
		FILLER_14,
		FILLER_15,
		FILLER_16,
		FILLER_17,
		FILLER_18,
		FILLER_19,
		PROVENIENZA,
		USERUPD,
		DATEUPD
    FROM
		RB_STG_DERIVATIVES_01
  ) DATA01
  ON
    KEYS.MONTH_END_DATE = DATA01.MONTH_END_DATE
    AND KEYS.REPORTING_ENTITY = DATA01.REPORTING_ENTITY
    AND KEYS.RB_ROWID = DATA01.RB_ROWID
	AND KEYS.USERUPD = DATA01.USERUPD
  INNER JOIN
  (
    SELECT
		RB_ROWID,
		MONTH_END_DATE,
		REPORTING_ENTITY,
		MANUAL_ADJUSTMENTS,
		FILLER_20,
		FILLER_21,
		FILLER_22,
		FILLER_23,
		FILLER_24,
		FILLER_25,
		PROVENIENZA,
		USERUPD,
		DATEUPD
    FROM
		RB_STG_DERIVATIVES_02
  ) DATA02
  ON
	KEYS.MONTH_END_DATE = DATA02.MONTH_END_DATE
	AND KEYS.REPORTING_ENTITY = DATA02.REPORTING_ENTITY
	AND KEYS.RB_ROWID = DATA02.RB_ROWID
	AND KEYS.USERUPD = DATA02.USERUPD
;