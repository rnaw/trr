--------------------------------------------------------
--  DDL for View RB_V_HST_LOAN
--------------------------------------------------------

  CREATE OR REPLACE FORCE VIEW "RB_V_HST_LOAN" (
	"RB_ROWID",
	"MONTH_END_DATE",
	"REPORTING_ENTITY",
	"INSTRUMENT",
	"INTERCOMPANY",
	"CALL_CODE",
	"CALL_CODE_DESC",
	"BASE_EQUIVALENT",
	"PROD_GROUP_DESC",
	"PROD_GROUP_TYPE_DESC",
	"CUSTOMER_ID",
	"CUSTOMER_NAME",
	"CUSTOMER_TYPE",
	"RELATED_DEP_INST_YESNO",
	"PURPOSE_CODE",
	"FOREIGN_DOMESTIC",
	"CUST_PARENT_FOREIGN_DOMESTIC",
	"COUNTRY_CODE",
	"COUNTRY_DESC",
	"RISK_COUNTRY",
	"OPERATING_STATE",
	"LOAN_USED_IN_STATE",
	"BORROWER_COUNTY",
	"LOAN_USED_IN_COUNTY",
	"AFFL_CONSOL_NODE",
	"DAY_COUNT_BASIS",
	"SOURCE",
	"HIGHLVL_PROD_CAT",
	"GL_KEY_CODE",
	"GL_KEY_CODE_DESC",
	"PRINCIPAL_GL_US_GAAP_BASE_EQ",
	"ACC_INT_GL_US_GAAP_BASE_EQ",
	"DEF_FEES_GL_US_GAAP_BASE_EQ",
	"UNEARN_FEES_GL_US_GAAP_BASE_EQ",
	"SPCFC_RESRV_GL_US_GAAP_BASE_EQ",
	"INT_INC_GL_US_GAAP_BASE_EQ",
	"FEES_GL_US_GAAP_BASE_EQ",
	"PRINCIPAL_GL_IFRS_BASE_EQ",
	"ACC_INT_GL_IFRS_BASE_EQ",
	"DEFERRED_FEES_GL_IFRS_BASE_EQ",
	"UNEARNED_FEES_GL_IFRS_BASE_EQ",
	"SPCFC_RESRV_GL_IFRS_BASE_EQ",
	"INT_INC_GL_IFRS_BASE_EQ",
	"FEES_GL_IFRS_BASE_EQ",
	"UMD1",
	"UMD2",
	"UMD3",
	"CONSOL_NODE",
	"SUB_LE1",
	"SUB_LE2",
	"BUSINESS_UNIT",
	"BUSINESS_LINE",
	"CURRENCY_CODE",
	"LEGAL_CUST_TOTAL_COMMIT",
	"LEGAL_CUST_PRINC_FUNDED",
	"LEGAL_CUST_UNFUNDED_COMMIT",
	"LEGAL_CUST_INT_OWED",
	"BANK_SHARE_PRINC_IFRS",
	"BANK_SHARE_PRINC_US_GAAP",
	"BANK_SHARE_TOTAL_COMMIT",
	"BANK_SHARE_UNFUNDED_COMMIT",
	"BANK_SPECIFIC_RESRV_US_GAAP",
	"UNEARNED_FEES_US_GAAP",
	"CHARGED_OFF_US_GAAP",
	"CHARGED_OFF_IFRS",
	"SPECIFIC_RESRV_IFRS",
	"NON_ACC_INTEREST_DIFF_US_GAAP",
	"INTEREST_APPLIED_PRINC_US_GAAP",
	"NON_ACC_INTEREST_DIFF_IFRS",
	"INTEREST_APPLLIED_PRINC_IFRS",
	"UNEARNED_FEE_IFRS",
	"LEDGER_ACCRUED_INTEREST_IFRS",
	"LEDG_ACC_INTEREST_US_GAAP",
	"INTEREST_PL_MTD_IFRS",
	"INTEREST_PL_MTD_US_GAAP",
	"INTEREST_PL_QTD_IFRS",
	"INTEREST_PL_QTD_US_GAAP",
	"INTEREST_PL_YTD_IFRS",
	"INTEREST_PL_YTD_US_GAAP",
	"ORIGINAL_PREMIUM_DISCOUNT",
	"REMAINING_PREMIUM_DISCOUNT",
	"ORIGINATION_DATE",
	"MATURITY_DATE",
	"ORIGINAL_INTEREST_RATE",
	"REVOLVER_YN",
	"RATE_EFFECTIVE_DATE",
	"RATE_EXPIRATION_DATE",
	"INTEREST_RATE",
	"OVER_UNDER_RATE_INDEX",
	"NOTE_CEILING_RATE",
	"NOTE_FLOOR_RATE",
	"NEXT_RATE_RESET_DATE",
	"LAST_RATE_RESET_DATE",
	"RATE_RESET_FREQUENCY",
	"LAST_REPRICING_DATE",
	"RB_INDEX",
	"FIXED_OR_VARIABLE",
	"BOOK_INDICATOR_HTM_OR_AFS",
	"IF_AFS_THEN_FV_BALANCE",
	"CUSTOMER_PARENT",
	"AMORTIZATION_METHOD",
	"COF_FTP_RATE",
	"SPREAD",
	"FED_CALL_CODE",
	"ZIP_CODE",
	"REAL_ESTATE_ZIP_CODE",
	"PCT_OWNED",
	"MATURITY_REPORTING",
	"MATURITY_BUCKETS",
	"PAST_DUE_YN",
	"NUMBER_OF_DAYS_PAST_DUE",
	"RB_SECURED_DE",
	"RB_ACCTG_METD_DESC",
	"NON_ACCRUAL_YN",
	"DATE_NON_ACCRUAL",
	"TDR_YN",
	"DATE_TDR",
	"TDR_COMP_WITH_MOD_TERMS_YN",
	"TDR_TYPE",
	"GOVT_GUARANTEED_AGENCY",
	"GOVT_GUARANTEED_PERCENTAGE",
	"US_GAAP_RISK_RATING",
	"IFRS_RISK_RATING",
	"IN_PROCESS_OF_FORECLOSURE",
	"ACQUIRED_IN_BUS_COMBINATION_YN",
	"SOP03_3_ACCTNG_TREATMENT_YN",
	"FV_LN_ACQ_IN_BUS_COMB_AT_ACQSN",
	"GROSS_CNTRCT_AMT_REC_AT_ACQSN",
	"ESTCNTRCL_CSFLW_NOEXPCTD2BCLTD",
	"SYNDICATED_PARTICIPATED_LOAN",
	"AGENT_PARTICIPANT",
	"PORTION_OF_SYNDICATED_LOAN_HFS",
	"UMD_3",
	"UMD_4",
	"UMD_5",
	"CO_BORROWER_ID",
	"CO_BORROWER_NAME",
	"RELATIONSHIP_MANAGER_NAME",
	"NAICS_CODE",
	"NAICS_DESC",
	"INDUSTRIES",
	"RAPID_COLLATERAL_TYPE",
	"FAC_LEVEL_LINK",
	"RB_FAC_NAME",
	"FACILITY_BORROWER_CIF",
	"FACILITY_BORROWER_NAME",
	"FACILITY_TRADE_ID",
	"FAC_OUTSTANDING_AVAILABLE_AMT",
	"FACILITY_LIMIT_AMOUNT",
	"FACILITY_USED_AMOUNT",
	"FACILITY_ORIGINAL_CURRENCY",
	"FAC_OUTSTANDING_GL_ORI_CUR_AMT",
	"FACILITY_START_DATE",
	"FACILITY_END_DATE",
	"LENDER_TYPE_DESC",
	"GLOBAL_SECTOR",
	"LOCAL_SECTOR",
	"REGULATORY_RISK_RATING",
	"VARIABLE_INTEREST_ENTITY",
	"UMD_7",
	"UMD_8",
	"UMD_9",
	"TRADE_ID",
	"PROD_GROUP",
	"ACBS_LENDER_TYPE",
	"FED_CALL_CODE2",
	"RESCOUNTRY_OF_CUSTOMER",
	"CIF_TYPE",
	"CIF_DESCRIPTION_PHOENIX",
	"CODE_OF_PARENT_PHOENIX",
	"DESC_OF_PARENT_PHOENIX",
	"RESCOUNTRY_OF_PARENT",
	"PORTFOLIO",
	"PRODUCT_TYPE",
	"IS_REPORTABLE_LOAN_YN",
	"BU",
	"ACCOUNT",
	"PRODUCT",
	"OPERATING_UNIT",
	"DEPTID",
	"AFFILIATE",
	"OBU_AFFILIATE",
	"CUST_CLASS",
	"CODEBLOCK",
	"DEFERRED_CODEBLOCK",
	"RESERVE_CODEBLOCK",
	"DESCRIPTION",
	"FILLER_1",
	"FILLER_2",
	"FILLER_3",
	"FILLER_4",
	"FILLER_5",
	"FILLER_6",
	"FILLER_7",
	"FILLER_8",
	"FILLER_9",
	"FILLER_10",
	"FILLER_11",
	"FILLER_12",
	"FILLER_13",
	"FILLER_14",
	"FILLER_15",
	"FILLER_16",
	"FILLER_17",
	"FILLER_18",
	"FILLER_19",
	"FILLER_20",
	"FILLER_21",
	"FILLER_22",
	"FILLER_23",
	"FILLER_24",
	"FILLER_25",
	"PROVENIENZA",
	"USERUPD",
	"DATEUPD"
) AS 
  SELECT
    CAST(KEYS.RB_ROWID AS NUMBER) AS RB_ROWID,
    TO_DATE(KEYS.MONTH_END_DATE, 'MM/DD/YYYY') AS MONTH_END_DATE,
    CAST(KEYS.REPORTING_ENTITY AS VARCHAR2(6)) AS REPORTING_ENTITY,
    CAST(DATA01.INSTRUMENT AS VARCHAR2(27)) AS INSTRUMENT,
    CAST(DATA01.INTERCOMPANY AS VARCHAR2(15)) AS INTERCOMPANY,
    CAST(DATA01.CALL_CODE AS VARCHAR2(15)) AS CALL_CODE,
    CAST(DATA01.CALL_CODE_DESC AS VARCHAR2(50)) AS CALL_CODE_DESC,
    CAST(DATA01.BASE_EQUIVALENT AS NUMBER(23,3)) AS BASE_EQUIVALENT,
    CAST(DATA01.PROD_GROUP_DESC AS VARCHAR2(100)) AS PROD_GROUP_DESC,
    CAST(DATA01.PROD_GROUP_TYPE_DESC AS VARCHAR2(100)) AS PROD_GROUP_TYPE_DESC,
    CAST(DATA01.CUSTOMER_ID AS VARCHAR2(10)) AS CUSTOMER_ID,
    CAST(DATA01.CUSTOMER_NAME AS VARCHAR2(50)) AS CUSTOMER_NAME,
    CAST(DATA01.CUSTOMER_TYPE AS VARCHAR2(30)) AS CUSTOMER_TYPE,
    CAST(DATA01.RELATED_DEP_INST_YESNO AS VARCHAR2(5)) AS RELATED_DEP_INST_YESNO,
    CAST(DATA01.PURPOSE_CODE AS VARCHAR2(50)) AS PURPOSE_CODE,
    CAST(DATA01.FOREIGN_DOMESTIC AS VARCHAR2(8)) AS FOREIGN_DOMESTIC,
    CAST(DATA01.CUST_PARENT_FOREIGN_DOMESTIC AS VARCHAR2(15)) AS CUST_PARENT_FOREIGN_DOMESTIC,
    CAST(DATA01.COUNTRY_CODE AS VARCHAR2(5)) AS COUNTRY_CODE,
    CAST(DATA01.COUNTRY_DESC AS VARCHAR2(30)) AS COUNTRY_DESC,
    CAST(DATA01.RISK_COUNTRY AS VARCHAR2(50)) AS RISK_COUNTRY,
    CAST(DATA01.OPERATING_STATE AS VARCHAR2(10)) AS OPERATING_STATE,
    CAST(DATA01.LOAN_USED_IN_STATE AS VARCHAR2(10)) AS LOAN_USED_IN_STATE,
    CAST(DATA01.BORROWER_COUNTY AS VARCHAR2(50)) AS BORROWER_COUNTY,
    CAST(DATA01.LOAN_USED_IN_COUNTY AS VARCHAR2(50)) AS LOAN_USED_IN_COUNTY,
    CAST(DATA01.AFFL_CONSOL_NODE AS VARCHAR2(30)) AS AFFL_CONSOL_NODE,
    CAST(DATA01.DAY_COUNT_BASIS AS VARCHAR2(30)) AS DAY_COUNT_BASIS,
    CAST(DATA01.SOURCE AS VARCHAR2(4)) AS SOURCE,
    CAST(DATA01.HIGHLVL_PROD_CAT AS VARCHAR2(10)) AS HIGHLVL_PROD_CAT,
    CAST(DATA01.GL_KEY_CODE AS VARCHAR2(15)) AS GL_KEY_CODE,
    CAST(DATA01.GL_KEY_CODE_DESC AS VARCHAR2(50)) AS GL_KEY_CODE_DESC,
    CAST(DATA01.PRINCIPAL_GL_US_GAAP_BASE_EQ AS NUMBER(23,3)) AS PRINCIPAL_GL_US_GAAP_BASE_EQ,
    CAST(DATA01.ACC_INT_GL_US_GAAP_BASE_EQ AS NUMBER(23,3)) AS ACC_INT_GL_US_GAAP_BASE_EQ,
    CAST(DATA01.DEF_FEES_GL_US_GAAP_BASE_EQ AS NUMBER(23,3)) AS DEF_FEES_GL_US_GAAP_BASE_EQ,
    CAST(DATA01.UNEARN_FEES_GL_US_GAAP_BASE_EQ AS NUMBER(23,3)) AS UNEARN_FEES_GL_US_GAAP_BASE_EQ,
    CAST(DATA01.SPCFC_RESRV_GL_US_GAAP_BASE_EQ AS NUMBER(23,3)) AS SPCFC_RESRV_GL_US_GAAP_BASE_EQ,
    CAST(DATA01.INT_INC_GL_US_GAAP_BASE_EQ AS NUMBER(23,3)) AS INT_INC_GL_US_GAAP_BASE_EQ,
    CAST(DATA01.FEES_GL_US_GAAP_BASE_EQ AS NUMBER(23,3)) AS FEES_GL_US_GAAP_BASE_EQ,
    CAST(DATA01.PRINCIPAL_GL_IFRS_BASE_EQ AS NUMBER(23,3)) AS PRINCIPAL_GL_IFRS_BASE_EQ,
    CAST(DATA01.ACC_INT_GL_IFRS_BASE_EQ AS NUMBER(23,3)) AS ACC_INT_GL_IFRS_BASE_EQ,
    CAST(DATA01.DEFERRED_FEES_GL_IFRS_BASE_EQ AS NUMBER(23,3)) AS DEFERRED_FEES_GL_IFRS_BASE_EQ,
    CAST(DATA01.UNEARNED_FEES_GL_IFRS_BASE_EQ AS NUMBER(23,3)) AS UNEARNED_FEES_GL_IFRS_BASE_EQ,
    CAST(DATA01.SPCFC_RESRV_GL_IFRS_BASE_EQ AS NUMBER(23,3)) AS SPCFC_RESRV_GL_IFRS_BASE_EQ,
    CAST(DATA01.INT_INC_GL_IFRS_BASE_EQ AS NUMBER(23,3)) AS INT_INC_GL_IFRS_BASE_EQ,
    CAST(DATA01.FEES_GL_IFRS_BASE_EQ AS NUMBER(23,3)) AS FEES_GL_IFRS_BASE_EQ,
    CAST(DATA01.UMD1 AS NUMBER(23,3)) AS UMD1,
    CAST(DATA01.UMD2 AS NUMBER(23,3)) AS UMD2,
    CAST(DATA01.UMD3 AS NUMBER(23,3)) AS UMD3,
    CAST(DATA01.CONSOL_NODE AS VARCHAR2(20)) AS CONSOL_NODE,
    CAST(DATA01.SUB_LE1 AS VARCHAR2(20)) AS SUB_LE1,
    CAST(DATA01.SUB_LE2 AS VARCHAR2(20)) AS SUB_LE2,
    CAST(DATA01.BUSINESS_UNIT AS VARCHAR2(5)) AS BUSINESS_UNIT,
    CAST(DATA01.BUSINESS_LINE AS VARCHAR2(20)) AS BUSINESS_LINE,
    CAST(DATA01.CURRENCY_CODE AS VARCHAR2(3)) AS CURRENCY_CODE,
    CAST(DATA01.LEGAL_CUST_TOTAL_COMMIT AS NUMBER(23,3)) AS LEGAL_CUST_TOTAL_COMMIT,
    CAST(DATA01.LEGAL_CUST_PRINC_FUNDED AS NUMBER(23,3)) AS LEGAL_CUST_PRINC_FUNDED,
    CAST(DATA01.LEGAL_CUST_UNFUNDED_COMMIT AS NUMBER(23,3)) AS LEGAL_CUST_UNFUNDED_COMMIT,
    CAST(DATA01.LEGAL_CUST_INT_OWED AS NUMBER(23,3)) AS LEGAL_CUST_INT_OWED,
    CAST(DATA01.BANK_SHARE_PRINC_IFRS AS NUMBER(23,3)) AS BANK_SHARE_PRINC_IFRS,
    CAST(DATA01.BANK_SHARE_PRINC_US_GAAP AS NUMBER(23,3)) AS BANK_SHARE_PRINC_US_GAAP,
    CAST(DATA01.BANK_SHARE_TOTAL_COMMIT AS NUMBER(23,3)) AS BANK_SHARE_TOTAL_COMMIT,
    CAST(DATA01.BANK_SHARE_UNFUNDED_COMMIT AS NUMBER(23,3)) AS BANK_SHARE_UNFUNDED_COMMIT,
    CAST(DATA01.BANK_SPECIFIC_RESRV_US_GAAP AS NUMBER(23,3)) AS BANK_SPECIFIC_RESRV_US_GAAP,
    CAST(DATA01.UNEARNED_FEES_US_GAAP AS NUMBER(23,3)) AS UNEARNED_FEES_US_GAAP,
    CAST(DATA01.CHARGED_OFF_US_GAAP AS NUMBER(23,3)) AS CHARGED_OFF_US_GAAP,
    CAST(DATA01.CHARGED_OFF_IFRS AS NUMBER(23,3)) AS CHARGED_OFF_IFRS,
    CAST(DATA01.SPECIFIC_RESRV_IFRS AS NUMBER(23,3)) AS SPECIFIC_RESRV_IFRS,
    CAST(DATA01.NON_ACC_INTEREST_DIFF_US_GAAP AS NUMBER(23,3)) AS NON_ACC_INTEREST_DIFF_US_GAAP,
    CAST(DATA01.INTEREST_APPLIED_PRINC_US_GAAP AS NUMBER(23,3)) AS INTEREST_APPLIED_PRINC_US_GAAP,
    CAST(DATA01.NON_ACC_INTEREST_DIFF_IFRS AS NUMBER(23,3)) AS NON_ACC_INTEREST_DIFF_IFRS,
    CAST(DATA01.INTEREST_APPLLIED_PRINC_IFRS AS NUMBER(23,3)) AS INTEREST_APPLLIED_PRINC_IFRS,
    CAST(DATA01.UNEARNED_FEE_IFRS AS NUMBER(23,3)) AS UNEARNED_FEE_IFRS,
    CAST(DATA01.LEDGER_ACCRUED_INTEREST_IFRS AS NUMBER(23,3)) AS LEDGER_ACCRUED_INTEREST_IFRS,
    CAST(DATA01.LEDG_ACC_INTEREST_US_GAAP AS NUMBER(23,3)) AS LEDG_ACC_INTEREST_US_GAAP,
    CAST(DATA01.INTEREST_PL_MTD_IFRS AS NUMBER(23,3)) AS INTEREST_PL_MTD_IFRS,
    CAST(DATA01.INTEREST_PL_MTD_US_GAAP AS NUMBER(23,3)) AS INTEREST_PL_MTD_US_GAAP,
    CAST(DATA01.INTEREST_PL_QTD_IFRS AS NUMBER(23,3)) AS INTEREST_PL_QTD_IFRS,
    CAST(DATA01.INTEREST_PL_QTD_US_GAAP AS NUMBER(23,3)) AS INTEREST_PL_QTD_US_GAAP,
    CAST(DATA01.INTEREST_PL_YTD_IFRS AS NUMBER(23,3)) AS INTEREST_PL_YTD_IFRS,
    CAST(DATA01.INTEREST_PL_YTD_US_GAAP AS NUMBER(23,3)) AS INTEREST_PL_YTD_US_GAAP,
    CAST(DATA01.ORIGINAL_PREMIUM_DISCOUNT AS NUMBER(23,3)) AS ORIGINAL_PREMIUM_DISCOUNT,
    CAST(DATA01.REMAINING_PREMIUM_DISCOUNT AS NUMBER(23,3)) AS REMAINING_PREMIUM_DISCOUNT,
    TO_DATE(DATA01.ORIGINATION_DATE, 'MM/DD/YYYY') AS ORIGINATION_DATE,
    TO_DATE(DATA01.MATURITY_DATE, 'MM/DD/YYYY') AS MATURITY_DATE,
    CAST(DATA01.ORIGINAL_INTEREST_RATE AS NUMBER(23,3)) AS ORIGINAL_INTEREST_RATE,
    CAST(DATA01.REVOLVER_YN AS VARCHAR2(5)) AS REVOLVER_YN,
    TO_DATE(DATA01.RATE_EFFECTIVE_DATE, 'MM/DD/YYYY') AS RATE_EFFECTIVE_DATE,
    TO_DATE(DATA01.RATE_EXPIRATION_DATE, 'MM/DD/YYYY') AS RATE_EXPIRATION_DATE,
    CAST(DATA01.INTEREST_RATE AS NUMBER(23,3)) AS INTEREST_RATE,
    CAST(DATA01.OVER_UNDER_RATE_INDEX AS VARCHAR2(10)) AS OVER_UNDER_RATE_INDEX,
    CAST(DATA01.NOTE_CEILING_RATE AS NUMBER(23,3)) AS NOTE_CEILING_RATE,
    CAST(DATA01.NOTE_FLOOR_RATE AS NUMBER(23,3)) AS NOTE_FLOOR_RATE,
    TO_DATE(DATA01.NEXT_RATE_RESET_DATE, 'MM/DD/YYYY') AS NEXT_RATE_RESET_DATE,
    TO_DATE(DATA01.LAST_RATE_RESET_DATE, 'MM/DD/YYYY') AS LAST_RATE_RESET_DATE,
    CAST(DATA01.RATE_RESET_FREQUENCY AS VARCHAR2(20)) AS RATE_RESET_FREQUENCY,
    TO_DATE(DATA01.LAST_REPRICING_DATE, 'MM/DD/YYYY') AS LAST_REPRICING_DATE,
    CAST(DATA01.RB_INDEX AS VARCHAR2(20)) AS RB_INDEX,
    CAST(DATA01.FIXED_OR_VARIABLE AS VARCHAR2(20)) AS FIXED_OR_VARIABLE,
    CAST(DATA01.BOOK_INDICATOR_HTM_OR_AFS AS VARCHAR2(10)) AS BOOK_INDICATOR_HTM_OR_AFS,
    CAST(DATA01.IF_AFS_THEN_FV_BALANCE AS NUMBER(23,3)) AS IF_AFS_THEN_FV_BALANCE,
    CAST(DATA01.CUSTOMER_PARENT AS VARCHAR2(20)) AS CUSTOMER_PARENT,
    CAST(DATA01.AMORTIZATION_METHOD AS VARCHAR2(20)) AS AMORTIZATION_METHOD,
    CAST(DATA01.COF_FTP_RATE AS NUMBER(23,3)) AS COF_FTP_RATE,
    CAST(DATA01.SPREAD AS NUMBER(23,3)) AS SPREAD,
    CAST(DATA01.FED_CALL_CODE AS VARCHAR2(20)) AS FED_CALL_CODE,
    CAST(DATA01.ZIP_CODE AS VARCHAR2(10)) AS ZIP_CODE,
    CAST(DATA01.REAL_ESTATE_ZIP_CODE AS VARCHAR2(10)) AS REAL_ESTATE_ZIP_CODE,
    CAST(DATA01.PCT_OWNED AS NUMBER(23,3)) AS PCT_OWNED,
    CAST(DATA01.MATURITY_REPORTING AS VARCHAR2(50)) AS MATURITY_REPORTING,
    CAST(DATA01.MATURITY_BUCKETS AS VARCHAR2(50)) AS MATURITY_BUCKETS,
    CAST(DATA01.PAST_DUE_YN AS VARCHAR2(10)) AS PAST_DUE_YN,
    CAST(DATA02.NUMBER_OF_DAYS_PAST_DUE AS NUMBER(23,3)) AS NUMBER_OF_DAYS_PAST_DUE,
    CAST(DATA02.RB_SECURED_DE AS VARCHAR2(20)) AS RB_SECURED_DE,
    CAST(DATA02.RB_ACCTG_METD_DESC AS VARCHAR2(20)) AS RB_ACCTG_METD_DESC,
    CAST(DATA02.NON_ACCRUAL_YN AS VARCHAR2(10)) AS NON_ACCRUAL_YN,
    TO_DATE(DATA02.DATE_NON_ACCRUAL, 'MM/DD/YYYY') AS DATE_NON_ACCRUAL,
    CAST(DATA02.TDR_YN AS VARCHAR2(10)) AS TDR_YN,
    TO_DATE(DATA02.DATE_TDR, 'MM/DD/YYYY') AS DATE_TDR,
    CAST(DATA02.TDR_COMP_WITH_MOD_TERMS_YN AS VARCHAR2(10)) AS TDR_COMP_WITH_MOD_TERMS_YN,
    CAST(DATA02.TDR_TYPE AS VARCHAR2(50)) AS TDR_TYPE,
    CAST(DATA02.GOVT_GUARANTEED_AGENCY AS VARCHAR2(50)) AS GOVT_GUARANTEED_AGENCY,
    CAST(DATA02.GOVT_GUARANTEED_PERCENTAGE AS NUMBER(23,3)) AS GOVT_GUARANTEED_PERCENTAGE,
    CAST(DATA02.US_GAAP_RISK_RATING AS VARCHAR2(20)) AS US_GAAP_RISK_RATING,
    CAST(DATA02.IFRS_RISK_RATING AS VARCHAR2(20)) AS IFRS_RISK_RATING,
    CAST(DATA02.IN_PROCESS_OF_FORECLOSURE AS VARCHAR2(20)) AS IN_PROCESS_OF_FORECLOSURE,
    CAST(DATA02.ACQUIRED_IN_BUS_COMBINATION_YN AS VARCHAR2(10)) AS ACQUIRED_IN_BUS_COMBINATION_YN,
    CAST(DATA02.SOP03_3_ACCTNG_TREATMENT_YN AS VARCHAR2(10)) AS SOP03_3_ACCTNG_TREATMENT_YN,
    CAST(DATA02.FV_LN_ACQ_IN_BUS_COMB_AT_ACQSN AS NUMBER(23,3)) AS FV_LN_ACQ_IN_BUS_COMB_AT_ACQSN,
    CAST(DATA02.GROSS_CNTRCT_AMT_REC_AT_ACQSN AS NUMBER(23,3)) AS GROSS_CNTRCT_AMT_REC_AT_ACQSN,
    CAST(DATA02.ESTCNTRCL_CSFLW_NOEXPCTD2BCLTD AS NUMBER(23,3)) AS ESTCNTRCL_CSFLW_NOEXPCTD2BCLTD,
    CAST(DATA02.SYNDICATED_PARTICIPATED_LOAN AS NUMBER(23,3)) AS SYNDICATED_PARTICIPATED_LOAN,
    CAST(DATA02.AGENT_PARTICIPANT AS VARCHAR2(20)) AS AGENT_PARTICIPANT,
    CAST(DATA02.PORTION_OF_SYNDICATED_LOAN_HFS AS NUMBER(23,3)) AS PORTION_OF_SYNDICATED_LOAN_HFS,
    CAST(DATA02.UMD_3 AS VARCHAR2(250)) AS UMD_3,
    CAST(DATA02.UMD_4 AS VARCHAR2(250)) AS UMD_4,
    CAST(DATA02.UMD_5 AS VARCHAR2(250)) AS UMD_5,
    CAST(DATA02.CO_BORROWER_ID AS VARCHAR2(20)) AS CO_BORROWER_ID,
    CAST(DATA02.CO_BORROWER_NAME AS VARCHAR2(50)) AS CO_BORROWER_NAME,
    CAST(DATA02.RELATIONSHIP_MANAGER_NAME AS VARCHAR2(50)) AS RELATIONSHIP_MANAGER_NAME,
    CAST(DATA02.NAICS_CODE AS VARCHAR2(35)) AS NAICS_CODE,
    CAST(DATA02.NAICS_DESC AS VARCHAR2(150)) AS NAICS_DESC,
    CAST(DATA02.INDUSTRIES AS VARCHAR2(50)) AS INDUSTRIES,
    CAST(DATA02.RAPID_COLLATERAL_TYPE AS VARCHAR2(50)) AS RAPID_COLLATERAL_TYPE,
    CAST(DATA02.FAC_LEVEL_LINK AS VARCHAR2(50)) AS FAC_LEVEL_LINK,
    CAST(DATA02.RB_FAC_NAME AS VARCHAR2(20)) AS RB_FAC_NAME,
    CAST(DATA02.FACILITY_BORROWER_CIF AS VARCHAR2(20)) AS FACILITY_BORROWER_CIF,
    CAST(DATA02.FACILITY_BORROWER_NAME AS VARCHAR2(50)) AS FACILITY_BORROWER_NAME,
    CAST(DATA02.FACILITY_TRADE_ID AS VARCHAR2(20)) AS FACILITY_TRADE_ID,
    CAST(DATA02.FAC_OUTSTANDING_AVAILABLE_AMT AS NUMBER(23,3)) AS FAC_OUTSTANDING_AVAILABLE_AMT,
    CAST(DATA02.FACILITY_LIMIT_AMOUNT AS NUMBER(23,3)) AS FACILITY_LIMIT_AMOUNT,
    CAST(DATA02.FACILITY_USED_AMOUNT AS NUMBER(23,3)) AS FACILITY_USED_AMOUNT,
    CAST(DATA02.FACILITY_ORIGINAL_CURRENCY AS VARCHAR2(3)) AS FACILITY_ORIGINAL_CURRENCY,
    CAST(DATA02.FAC_OUTSTANDING_GL_ORI_CUR_AMT AS NUMBER(23,3)) AS FAC_OUTSTANDING_GL_ORI_CUR_AMT,
    TO_DATE(DATA02.FACILITY_START_DATE, 'MM/DD/YYYY') AS FACILITY_START_DATE,
    TO_DATE(DATA02.FACILITY_END_DATE, 'MM/DD/YYYY') AS FACILITY_END_DATE,
    CAST(DATA02.LENDER_TYPE_DESC AS VARCHAR2(20)) AS LENDER_TYPE_DESC,
    CAST(DATA02.GLOBAL_SECTOR AS VARCHAR2(30)) AS GLOBAL_SECTOR,
    CAST(DATA02.LOCAL_SECTOR AS VARCHAR2(30)) AS LOCAL_SECTOR,
    CAST(DATA02.REGULATORY_RISK_RATING AS VARCHAR2(20)) AS REGULATORY_RISK_RATING,
    CAST(DATA02.VARIABLE_INTEREST_ENTITY AS VARCHAR2(10)) AS VARIABLE_INTEREST_ENTITY,
    CAST(DATA02.UMD_7 AS VARCHAR2(250)) AS UMD_7,
    CAST(DATA02.UMD_8 AS VARCHAR2(250)) AS UMD_8,
    CAST(DATA02.UMD_9 AS VARCHAR2(250)) AS UMD_9,
    CAST(DATA02.TRADE_ID AS VARCHAR2(20)) AS TRADE_ID,
    CAST(DATA02.PROD_GROUP AS VARCHAR2(20)) AS PROD_GROUP,
    CAST(DATA02.ACBS_LENDER_TYPE AS VARCHAR2(20)) AS ACBS_LENDER_TYPE,
    CAST(DATA02.FED_CALL_CODE2 AS VARCHAR2(20)) AS FED_CALL_CODE2,
    CAST(DATA02.RESCOUNTRY_OF_CUSTOMER AS VARCHAR2(20)) AS RESCOUNTRY_OF_CUSTOMER,
    CAST(DATA02.CIF_TYPE AS VARCHAR2(20)) AS CIF_TYPE,
    CAST(DATA02.CIF_DESCRIPTION_PHOENIX AS VARCHAR2(50)) AS CIF_DESCRIPTION_PHOENIX,
    CAST(DATA02.CODE_OF_PARENT_PHOENIX AS VARCHAR2(20)) AS CODE_OF_PARENT_PHOENIX,
    CAST(DATA02.DESC_OF_PARENT_PHOENIX AS VARCHAR2(50)) AS DESC_OF_PARENT_PHOENIX,
    CAST(DATA02.RESCOUNTRY_OF_PARENT AS VARCHAR2(50)) AS RESCOUNTRY_OF_PARENT,
    CAST(DATA02.PORTFOLIO AS VARCHAR2(20)) AS PORTFOLIO,
    CAST(DATA02.PRODUCT_TYPE AS VARCHAR2(25)) AS PRODUCT_TYPE,
    CAST(DATA02.IS_REPORTABLE_LOAN_YN AS VARCHAR2(10)) AS IS_REPORTABLE_LOAN_YN,
    CAST(DATA02.BU AS VARCHAR2(10)) AS BU,
    CAST(DATA02.ACCOUNT AS VARCHAR2(10)) AS ACCOUNT,
    CAST(DATA02.PRODUCT AS VARCHAR2(6)) AS PRODUCT,
    CAST(DATA02.OPERATING_UNIT AS VARCHAR2(8)) AS OPERATING_UNIT,
    CAST(DATA02.DEPTID AS VARCHAR2(15)) AS DEPTID,
    CAST(DATA02.AFFILIATE AS VARCHAR2(5)) AS AFFILIATE,
    CAST(DATA02.OBU_AFFILIATE AS VARCHAR2(8)) AS OBU_AFFILIATE,
    CAST(DATA02.CUST_CLASS AS VARCHAR2(10)) AS CUST_CLASS,
    CAST(DATA02.CODEBLOCK AS VARCHAR2(100)) AS CODEBLOCK,
    CAST(DATA02.DEFERRED_CODEBLOCK AS VARCHAR2(100)) AS DEFERRED_CODEBLOCK,
    CAST(DATA02.RESERVE_CODEBLOCK AS VARCHAR2(100)) AS RESERVE_CODEBLOCK,
    CAST(DATA02.DESCRIPTION AS VARCHAR2(100)) AS DESCRIPTION,
    CAST(DATA02.FILLER_1 AS VARCHAR2(250)) AS FILLER_1,
    CAST(DATA02.FILLER_2 AS VARCHAR2(250)) AS FILLER_2,
    CAST(DATA02.FILLER_3 AS VARCHAR2(250)) AS FILLER_3,
    CAST(DATA02.FILLER_4 AS VARCHAR2(250)) AS FILLER_4,
    CAST(DATA02.FILLER_5 AS VARCHAR2(250)) AS FILLER_5,
    CAST(DATA02.FILLER_6 AS VARCHAR2(250)) AS FILLER_6,
    CAST(DATA02.FILLER_7 AS VARCHAR2(250)) AS FILLER_7,
    CAST(DATA02.FILLER_8 AS VARCHAR2(250)) AS FILLER_8,
    CAST(DATA02.FILLER_9 AS VARCHAR2(250)) AS FILLER_9,
    CAST(DATA02.FILLER_10 AS VARCHAR2(250)) AS FILLER_10,
    CAST(DATA02.FILLER_11 AS VARCHAR2(250)) AS FILLER_11,
    CAST(DATA02.FILLER_12 AS VARCHAR2(250)) AS FILLER_12,
    CAST(DATA02.FILLER_13 AS VARCHAR2(250)) AS FILLER_13,
    CAST(DATA02.FILLER_14 AS VARCHAR2(250)) AS FILLER_14,
    CAST(DATA02.FILLER_15 AS VARCHAR2(250)) AS FILLER_15,
    CAST(DATA02.FILLER_16 AS VARCHAR2(250)) AS FILLER_16,
    CAST(DATA02.FILLER_17 AS VARCHAR2(250)) AS FILLER_17,
    CAST(DATA02.FILLER_18 AS VARCHAR2(250)) AS FILLER_18,
    CAST(DATA02.FILLER_19 AS VARCHAR2(250)) AS FILLER_19,
    CAST(DATA02.FILLER_20 AS VARCHAR2(250)) AS FILLER_20,
    CAST(DATA02.FILLER_21 AS VARCHAR2(250)) AS FILLER_21,
    CAST(DATA02.FILLER_22 AS VARCHAR2(250)) AS FILLER_22,
    CAST(DATA02.FILLER_23 AS VARCHAR2(250)) AS FILLER_23,
    CAST(DATA02.FILLER_24 AS VARCHAR2(250)) AS FILLER_24,
    CAST(DATA02.FILLER_25 AS VARCHAR2(250)) AS FILLER_25,
    DATA02.PROVENIENZA,
    KEYS.USERUPD,
    DATA02.DATEUPD
FROM
  (
    SELECT DISTINCT
		MONTH_END_DATE,
		REPORTING_ENTITY,
		RB_ROWID,
		USERUPD
    FROM
      RB_STG_LOAN_01
  ) KEYS
  INNER JOIN
  (
    SELECT
		"RB_ROWID",
		"MONTH_END_DATE",
		"REPORTING_ENTITY",
		"INSTRUMENT",
		"INTERCOMPANY",
		"CALL_CODE",
		"CALL_CODE_DESC",
		"BASE_EQUIVALENT",
		"PROD_GROUP_DESC",
		"PROD_GROUP_TYPE_DESC",
		"CUSTOMER_ID",
		"CUSTOMER_NAME",
		"CUSTOMER_TYPE",
		"RELATED_DEP_INST_YESNO",
		"PURPOSE_CODE",
		"FOREIGN_DOMESTIC",
		"CUST_PARENT_FOREIGN_DOMESTIC",
		"COUNTRY_CODE",
		"COUNTRY_DESC",
		"RISK_COUNTRY",
		"OPERATING_STATE",
		"LOAN_USED_IN_STATE",
		"BORROWER_COUNTY",
		"LOAN_USED_IN_COUNTY",
		"AFFL_CONSOL_NODE",
		"DAY_COUNT_BASIS",
		"SOURCE",
		"HIGHLVL_PROD_CAT",
		"GL_KEY_CODE",
		"GL_KEY_CODE_DESC",
		"PRINCIPAL_GL_US_GAAP_BASE_EQ",
		"ACC_INT_GL_US_GAAP_BASE_EQ",
		"DEF_FEES_GL_US_GAAP_BASE_EQ",
		"UNEARN_FEES_GL_US_GAAP_BASE_EQ",
		"SPCFC_RESRV_GL_US_GAAP_BASE_EQ",
		"INT_INC_GL_US_GAAP_BASE_EQ",
		"FEES_GL_US_GAAP_BASE_EQ",
		"PRINCIPAL_GL_IFRS_BASE_EQ",
		"ACC_INT_GL_IFRS_BASE_EQ",
		"DEFERRED_FEES_GL_IFRS_BASE_EQ",
		"UNEARNED_FEES_GL_IFRS_BASE_EQ",
		"SPCFC_RESRV_GL_IFRS_BASE_EQ",
		"INT_INC_GL_IFRS_BASE_EQ",
		"FEES_GL_IFRS_BASE_EQ",
		"UMD1",
		"UMD2",
		"UMD3",
		"CONSOL_NODE",
		"SUB_LE1",
		"SUB_LE2",
		"BUSINESS_UNIT",
		"BUSINESS_LINE",
		"CURRENCY_CODE",
		"LEGAL_CUST_TOTAL_COMMIT",
		"LEGAL_CUST_PRINC_FUNDED",
		"LEGAL_CUST_UNFUNDED_COMMIT",
		"LEGAL_CUST_INT_OWED",
		"BANK_SHARE_PRINC_IFRS",
		"BANK_SHARE_PRINC_US_GAAP",
		"BANK_SHARE_TOTAL_COMMIT",
		"BANK_SHARE_UNFUNDED_COMMIT",
		"BANK_SPECIFIC_RESRV_US_GAAP",
		"UNEARNED_FEES_US_GAAP",
		"CHARGED_OFF_US_GAAP",
		"CHARGED_OFF_IFRS",
		"SPECIFIC_RESRV_IFRS",
		"NON_ACC_INTEREST_DIFF_US_GAAP",
		"INTEREST_APPLIED_PRINC_US_GAAP",
		"NON_ACC_INTEREST_DIFF_IFRS",
		"INTEREST_APPLLIED_PRINC_IFRS",
		"UNEARNED_FEE_IFRS",
		"LEDGER_ACCRUED_INTEREST_IFRS",
		"LEDG_ACC_INTEREST_US_GAAP",
		"INTEREST_PL_MTD_IFRS",
		"INTEREST_PL_MTD_US_GAAP",
		"INTEREST_PL_QTD_IFRS",
		"INTEREST_PL_QTD_US_GAAP",
		"INTEREST_PL_YTD_IFRS",
		"INTEREST_PL_YTD_US_GAAP",
		"ORIGINAL_PREMIUM_DISCOUNT",
		"REMAINING_PREMIUM_DISCOUNT",
		"ORIGINATION_DATE",
		"MATURITY_DATE",
		"ORIGINAL_INTEREST_RATE",
		"REVOLVER_YN",
		"RATE_EFFECTIVE_DATE",
		"RATE_EXPIRATION_DATE",
		"INTEREST_RATE",
		"OVER_UNDER_RATE_INDEX",
		"NOTE_CEILING_RATE",
		"NOTE_FLOOR_RATE",
		"NEXT_RATE_RESET_DATE",
		"LAST_RATE_RESET_DATE",
		"RATE_RESET_FREQUENCY",
		"LAST_REPRICING_DATE",
		"RB_INDEX",
		"FIXED_OR_VARIABLE",
		"BOOK_INDICATOR_HTM_OR_AFS",
		"IF_AFS_THEN_FV_BALANCE",
		"CUSTOMER_PARENT",
		"AMORTIZATION_METHOD",
		"COF_FTP_RATE",
		"SPREAD",
		"FED_CALL_CODE",
		"ZIP_CODE",
		"REAL_ESTATE_ZIP_CODE",
		"PCT_OWNED",
		"MATURITY_REPORTING",
		"MATURITY_BUCKETS",
		"PAST_DUE_YN",
		USERUPD
    FROM
		RB_STG_LOAN_01
  ) DATA01
  ON
    KEYS.MONTH_END_DATE = DATA01.MONTH_END_DATE
    AND KEYS.REPORTING_ENTITY = DATA01.REPORTING_ENTITY
    AND KEYS.RB_ROWID = DATA01.RB_ROWID
	AND KEYS.USERUPD = DATA01.USERUPD
  INNER JOIN
  (
    SELECT
		RB_ROWID,
		MONTH_END_DATE,
		REPORTING_ENTITY,
		"NUMBER_OF_DAYS_PAST_DUE",
		"RB_SECURED_DE",
		"RB_ACCTG_METD_DESC",
		"NON_ACCRUAL_YN",
		"DATE_NON_ACCRUAL",
		"TDR_YN",
		"DATE_TDR",
		"TDR_COMP_WITH_MOD_TERMS_YN",
		"TDR_TYPE",
		"GOVT_GUARANTEED_AGENCY",
		"GOVT_GUARANTEED_PERCENTAGE",
		"US_GAAP_RISK_RATING",
		"IFRS_RISK_RATING",
		"IN_PROCESS_OF_FORECLOSURE",
		"ACQUIRED_IN_BUS_COMBINATION_YN",
		"SOP03_3_ACCTNG_TREATMENT_YN",
		"FV_LN_ACQ_IN_BUS_COMB_AT_ACQSN",
		"GROSS_CNTRCT_AMT_REC_AT_ACQSN",
		"ESTCNTRCL_CSFLW_NOEXPCTD2BCLTD",
		"SYNDICATED_PARTICIPATED_LOAN",
		"AGENT_PARTICIPANT",
		"PORTION_OF_SYNDICATED_LOAN_HFS",
		"UMD_3",
		"UMD_4",
		"UMD_5",
		"CO_BORROWER_ID",
		"CO_BORROWER_NAME",
		"RELATIONSHIP_MANAGER_NAME",
		"NAICS_CODE",
		"NAICS_DESC",
		"INDUSTRIES",
		"RAPID_COLLATERAL_TYPE",
		"FAC_LEVEL_LINK",
		"RB_FAC_NAME",
		"FACILITY_BORROWER_CIF",
		"FACILITY_BORROWER_NAME",
		"FACILITY_TRADE_ID",
		"FAC_OUTSTANDING_AVAILABLE_AMT",
		"FACILITY_LIMIT_AMOUNT",
		"FACILITY_USED_AMOUNT",
		"FACILITY_ORIGINAL_CURRENCY",
		"FAC_OUTSTANDING_GL_ORI_CUR_AMT",
		"FACILITY_START_DATE",
		"FACILITY_END_DATE",
		"LENDER_TYPE_DESC",
		"GLOBAL_SECTOR",
		"LOCAL_SECTOR",
		"REGULATORY_RISK_RATING",
		"VARIABLE_INTEREST_ENTITY",
		"UMD_7",
		"UMD_8",
		"UMD_9",
		"TRADE_ID",
		"PROD_GROUP",
		"ACBS_LENDER_TYPE",
		"FED_CALL_CODE2",
		"RESCOUNTRY_OF_CUSTOMER",
		"CIF_TYPE",
		"CIF_DESCRIPTION_PHOENIX",
		"CODE_OF_PARENT_PHOENIX",
		"DESC_OF_PARENT_PHOENIX",
		"RESCOUNTRY_OF_PARENT",
		"PORTFOLIO",
		"PRODUCT_TYPE",
		"IS_REPORTABLE_LOAN_YN",
		"BU",
		"ACCOUNT",
		"PRODUCT",
		"OPERATING_UNIT",
		"DEPTID",
		"AFFILIATE",
		"OBU_AFFILIATE",
		"CUST_CLASS",
		"CODEBLOCK",
		"DEFERRED_CODEBLOCK",
		"RESERVE_CODEBLOCK",
		"DESCRIPTION",
		"FILLER_1",
		"FILLER_2",
		"FILLER_3",
		"FILLER_4",
		"FILLER_5",
		"FILLER_6",
		"FILLER_7",
		"FILLER_8",
		"FILLER_9",
		"FILLER_10",
		"FILLER_11",
		"FILLER_12",
		"FILLER_13",
		"FILLER_14",
		"FILLER_15",
		"FILLER_16",
		"FILLER_17",
		"FILLER_18",
		"FILLER_19",
		"FILLER_20",
		"FILLER_21",
		"FILLER_22",
		"FILLER_23",
		"FILLER_24",
		"FILLER_25",
		PROVENIENZA,
		USERUPD,
		DATEUPD
    FROM
		RB_STG_LOAN_02
  ) DATA02
  ON
	KEYS.MONTH_END_DATE = DATA02.MONTH_END_DATE
	AND KEYS.REPORTING_ENTITY = DATA02.REPORTING_ENTITY
	AND KEYS.RB_ROWID = DATA02.RB_ROWID
	AND KEYS.USERUPD = DATA02.USERUPD
;